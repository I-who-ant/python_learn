# Emacs 实战练习教程:动手操作学 Emacs

## 课程目标

通过 10 个实战练习,让你在真实操作中掌握 Emacs 的核心功能。

**学习方法:**
1. **不要只看,必须动手做**
2. 每个练习标注了预计时间
3. 完成后打 ✓ 标记进度
4. 出错是正常的,用 `C-g` 取消重来

---

## 练习前准备

### 创建练习目录

```bash
mkdir -p ~/emacs-practice
cd ~/emacs-practice
```

### 启动 Emacs

```bash
# 图形界面
emacs &

# 或终端模式
emacs -nw
```

---

## 练习 1:第一次文件编辑(5 分钟)

### 目标
掌握最基本的文件创建、编辑、保存流程。

### 操作步骤

**步骤 1:创建新文件**
```
1. 按 C-x C-f
2. 输入:~/emacs-practice/hello.txt
3. 按回车
   (看到空白编辑区)
```

**步骤 2:输入内容**
```
输入以下文本:
Hello, this is my first Emacs file.
I am learning to use Emacs.
Today is a great day!
```

**步骤 3:保存文件**
```
按 C-x C-s
(底部显示:Wrote /home/你的用户名/emacs-practice/hello.txt)
```

**步骤 4:退出 Emacs**
```
按 C-x C-c
```

**步骤 5:重新打开验证**
```bash
emacs ~/emacs-practice/hello.txt
```

### ✓ 检查点
- [ ] 文件已创建
- [ ] 内容已保存
- [ ] 重新打开能看到内容

---

## 练习 2:光标移动训练(10 分钟)

### 目标
熟练使用快捷键移动光标,而不依赖方向键。

### 准备文件

**创建练习文件:**
```
按 C-x C-f
输入:~/emacs-practice/movement.txt
输入以下内容:

Line 1: The quick brown fox jumps over the lazy dog.
Line 2: Python is a powerful programming language.
Line 3: Emacs is an extensible text editor.
Line 4: Practice makes perfect in everything.
Line 5: Keep learning and stay curious.
```

### 操作练习

**练习 2.1:行内移动**
```
1. 光标移到文件开头:M-<
2. 移到行尾:C-e
3. 移到行首:C-a
4. 向右移动 5 个字符:C-f C-f C-f C-f C-f
5. 向左移动 3 个字符:C-b C-b C-b
```

**练习 2.2:按词移动**
```
1. 光标在 Line 1 行首
2. 向前移动 3 个词:M-f M-f M-f
   (应该在 "fox" 后)
3. 向后移动 1 个词:M-b
   (应该在 "brown" 前)
```

**练习 2.3:行间移动**
```
1. 移到第 3 行:M-g g 输入 3
2. 下移 2 行:C-n C-n
3. 上移 1 行:C-p
```

**练习 2.4:文件首尾**
```
1. 跳到文件结尾:M->
2. 跳到文件开头:M-<
```

### ✓ 检查点
- [ ] 能不用方向键移动光标
- [ ] 记住了 C-a, C-e, C-n, C-p
- [ ] 会用 M-< 和 M-> 跳转

---

## 练习 3:文本编辑实战(15 分钟)

### 目标
掌握删除、剪切、复制、粘贴操作。

### 准备文件

**创建编辑练习文件:**
```
按 C-x C-f
输入:~/emacs-practice/edit.txt
输入以下内容:

TODO:
1. Buy groceries
2. Finish homework
3. Call mom
4. Read book

DONE:
5. Wake up
```

### 操作练习

**练习 3.1:删除操作**
```
1. 光标移到 "Buy" 的 "B"
2. 删除 "Buy":M-d
3. 光标移到 "groceries" 的末尾
4. 删除到行尾:C-k
5. 撤销:C-/
```

**练习 3.2:复制粘贴**
```
任务:将 "Wake up" 复制到 TODO 列表开头

1. 光标移到 "Wake up" 的 "W"
2. 设置标记:C-SPC
3. 移到行尾:C-e
4. 复制:M-w
5. 光标移到第一行 "1. Buy" 前
6. 粘贴:C-y
7. 手动添加序号 "0. "

结果应该是:
TODO:
0. Wake up
1. Buy groceries
2. Finish homework
...
```

**练习 3.3:剪切移动**
```
任务:将 "Read book" 移到 DONE 列表

1. 光标移到 "4. Read book" 行首
2. 设置标记:C-SPC
3. 移到下一行开头:C-n C-a
4. 剪切:C-w
5. 移到 DONE 最后一行后
6. 粘贴:C-y
```

**练习 3.4:删除整行**
```
1. 光标移到任意一行
2. 删除整行:C-S-Backspace
```

### ✓ 检查点
- [ ] 能用 M-d 删词,C-k 删到行尾
- [ ] 理解 C-SPC + 移动 + M-w/C-w 的流程
- [ ] 会用 C-y 粘贴

---

## 练习 4:多窗口操作(10 分钟)

### 目标
学会分割窗口,在多个文件间切换。

### 操作练习

**练习 4.1:基础分割**
```
1. 打开 edit.txt
   C-x C-f ~/emacs-practice/edit.txt

2. 水平分割窗口(上下)
   C-x 2

3. 切换到下方窗口
   C-x o

4. 在下方窗口打开 hello.txt
   C-x C-f ~/emacs-practice/hello.txt
```

**练习 4.2:三窗口布局**
```
1. 在下方窗口再垂直分割(左右)
   C-x 3

   布局变成:
   ┌─────────────┐
   │  edit.txt   │
   ├──────┬──────┤
   │hello │hello │
   └──────┴──────┘

2. 切换窗口
   C-x o (多次按,循环切换)

3. 在右下窗口打开 movement.txt
   C-x C-f ~/emacs-practice/movement.txt
```

**练习 4.3:窗口管理**
```
1. 只保留当前窗口
   C-x 1

2. 重新分割(上下)
   C-x 2

3. 关闭当前窗口
   C-x 0
```

### ✓ 检查点
- [ ] 能用 C-x 2/3 分割窗口
- [ ] 能用 C-x o 切换窗口
- [ ] 理解 C-x 1 和 C-x 0 的区别

---

## 练习 5:搜索与替换(15 分钟)

### 目标
掌握高效的搜索和批量替换。

### 准备文件

**创建搜索练习文件:**
```
C-x C-f ~/emacs-practice/search.txt

输入以下内容:
The cat sat on the mat.
The cat saw a rat.
The rat ran from the cat.
The cat caught the rat.
The cat is a good cat.
```

### 操作练习

**练习 5.1:基础搜索**
```
1. 搜索 "cat"
   C-s
   输入:cat
   (第一个 "cat" 高亮)

2. 查找下一个
   C-s (再按)
   (跳到下一个 "cat")

3. 查找上一个
   C-r

4. 结束搜索
   按回车(留在当前位置)
```

**练习 5.2:增量搜索的便利性**
```
1. 按 C-s
2. 输入:c (所有 "c" 开头的词高亮)
3. 继续输入:a (变成 "ca" 开头)
4. 继续输入:t (变成 "cat" 精确匹配)
5. 按 C-g 取消
```

**练习 5.3:查找替换**
```
任务:将所有 "cat" 替换为 "dog"

1. 移到文件开头:M-<
2. 开始替换:M-%
3. 输入搜索词:cat [回车]
4. 输入替换词:dog [回车]
5. 逐个确认:
   - 第一个:按 y (替换)
   - 第二个:按 n (跳过)
   - 第三个:按 ! (替换剩余所有)

6. 撤销所有修改:C-/ (多次)
```

**练习 5.4:全部替换**
```
1. M-< (移到文件开头)
2. M-%
3. 输入:the [回车]
4. 输入:THE [回车]
5. 按 ! (全部替换,不询问)
```

### ✓ 检查点
- [ ] 能用 C-s 快速搜索
- [ ] 理解 M-% 的交互流程
- [ ] 记住 y/n/! 的含义

---

## 练习 6:Buffer 管理(10 分钟)

### 目标
学会在多个 buffer 间高效切换。

### 操作练习

**练习 6.1:打开多个文件**
```
依次打开 3 个文件:
1. C-x C-f ~/emacs-practice/hello.txt
2. C-x C-f ~/emacs-practice/edit.txt
3. C-x C-f ~/emacs-practice/search.txt
```

**练习 6.2:列出所有 buffer**
```
1. 按 C-x C-b
   (打开 *Buffer List* 窗口)

2. 查看列表:
   MR Buffer           Size  Mode
   -- ------           ----  ----
   .  search.txt       200   Text
      edit.txt         150   Text
      hello.txt        100   Text
   *  *Buffer List*    ...   ...

3. 关闭 Buffer List 窗口:C-x 1
```

**练习 6.3:快速切换**
```
1. 切换到 edit.txt
   C-x b edit.txt [回车]

2. 切换到 hello.txt
   C-x b hello.txt [回车]

3. 用方向键切换
   C-x → (下一个 buffer)
   C-x ← (上一个 buffer)
```

**练习 6.4:关闭 buffer**
```
1. 关闭当前 buffer
   C-x k [回车]
   (默认关闭当前 buffer)

2. 关闭指定 buffer
   C-x k edit.txt [回车]
```

### ✓ 检查点
- [ ] 能用 C-x b 切换 buffer
- [ ] 能用 C-x C-b 查看所有 buffer
- [ ] 能用 C-x k 关闭 buffer

---

## 练习 7:矩形编辑魔法(10 分钟)

### 目标
掌握 Emacs 独特的矩形编辑功能。

### 准备文件

**创建矩形编辑练习文件:**
```
C-x C-f ~/emacs-practice/rectangle.txt

输入以下内容(注意对齐):
apple      10
banana     20
cherry     30
date       40
```

### 操作练习

**练习 7.1:矩形插入**
```
任务:在每行开头插入 "- "

1. 光标移到 "apple" 的 "a" 前
2. 设置标记:C-SPC
3. 向下移动 3 行:C-n C-n C-n
   (选中了一个竖线形的矩形区域)
4. 矩形插入:C-x r t
5. 输入:"-  " (横杠+两个空格)
6. 按回车

结果:
-  apple      10
-  banana     20
-  cherry     30
-  date       40
```

**练习 7.2:矩形剪切**
```
任务:删除所有数字

1. 撤销上一步:C-/ (多次,恢复原样)
2. 光标移到第一个 "1" (数字 10 的 1)
3. 设置标记:C-SPC
4. 移动到最后一个数字后:
   C-n C-n C-n (向下 3 行)
   C-e (行尾)
5. 矩形剪切:C-x r k

结果:
apple
banana
cherry
date
```

**练习 7.3:矩形复制粘贴**
```
任务:复制水果名到末尾

1. 光标移到 "apple" 的 "a"
2. 设置标记:C-SPC
3. 选择所有水果名:
   C-n C-n C-n (向下 3 行)
   M-f (向右一个词)
4. 矩形复制:C-x r M-w
5. 移到文件末尾:M->
6. 新建一行:C-o
7. 矩形粘贴:C-x r y
```

### ✓ 检查点
- [ ] 理解矩形选区的概念(竖列)
- [ ] 能用 C-x r t 矩形插入
- [ ] 能用 C-x r k 矩形剪切

---

## 练习 8:Kill Ring 循环粘贴(10 分钟)

### 目标
理解 Emacs 的剪切板历史机制。

### 准备文件

**创建 Kill Ring 练习文件:**
```
C-x C-f ~/emacs-practice/killring.txt

输入以下内容:
ONE
TWO
THREE
FOUR
FIVE
```

### 操作练习

**练习 8.1:积累 Kill Ring**
```
1. 光标移到 "ONE" 行首
2. 删除整行:C-k C-k (第一次删内容,第二次删换行)
3. 删除 "TWO":C-k C-k
4. 删除 "THREE":C-k C-k

现在 Kill Ring 里有(从新到旧):
  [THREE] [TWO] [ONE]
```

**练习 8.2:循环粘贴**
```
1. 移到文件末尾:M->
2. 粘贴最近的:C-y
   (出现 "THREE")
3. 替换为上一个:M-y
   (变成 "TWO")
4. 再替换:M-y
   (变成 "ONE")
5. 继续按 M-y
   (循环回到 "THREE")
```

**练习 8.3:实战应用**
```
任务:按 FIVE, FOUR, THREE 顺序重组

1. 撤销到初始状态:C-/ (多次)
2. 依次剪切 FIVE, FOUR, THREE
3. 在末尾粘贴:C-y (FIVE)
4. 换行,粘贴:C-y M-y (FOUR)
5. 换行,粘贴:C-y M-y M-y (THREE)
```

### ✓ 检查点
- [ ] 理解 Kill Ring 是历史栈
- [ ] 能用 C-y 粘贴
- [ ] 能用 M-y 循环历史

---

## 练习 9:标记跳转(8 分钟)

### 目标
学会使用标记在文件中快速跳转。

### 准备文件

**使用之前的 movement.txt:**
```
C-x C-f ~/emacs-practice/movement.txt
```

### 操作练习

**练习 9.1:设置标记点**
```
1. 光标移到第 1 行
2. 设置标记:C-SPC C-SPC
   (底部显示:Mark set)

3. 光标移到第 3 行
4. 再设置标记:C-SPC C-SPC

5. 移到第 5 行
6. 再设置标记:C-SPC C-SPC
```

**练习 9.2:跳转回标记**
```
1. 移到文件结尾:M->
2. 跳回上一个标记:C-u C-SPC
   (跳到第 5 行)
3. 再跳回:C-u C-SPC
   (跳到第 3 行)
4. 再跳回:C-u C-SPC
   (跳到第 1 行)
```

**练习 9.3:实战应用**
```
场景:编辑长文件时需要在多处来回切换

1. 在需要记住的位置按 C-SPC C-SPC
2. 移到其他地方编辑
3. 用 C-u C-SPC 快速跳回
```

### ✓ 检查点
- [ ] 能用 C-SPC C-SPC 设置标记(不激活选区)
- [ ] 能用 C-u C-SPC 跳回
- [ ] 理解标记栈的概念

---

## 练习 10:综合实战项目(20 分钟)

### 目标
完成一个真实的文档编辑任务,综合运用所学技能。

### 任务描述

**创建一份购物清单管理器:**

**最终效果:**
```
========== 购物清单 ==========

[ ] 水果
    - [ ] 苹果 (5个)
    - [ ] 香蕉 (1串)
    - [ ] 橙子 (3个)

[ ] 蔬菜
    - [ ] 西红柿 (500g)
    - [ ] 黄瓜 (2根)

[ ] 日用品
    - [ ] 牙膏
    - [ ] 纸巾

[ ] 零食
    - [ ] 薯片
    - [ ] 巧克力

========== 预算 ==========
总计:¥150

========== 备注 ==========
周末去超市采购
```

### 操作步骤

**第 1 步:创建文件框架(5分钟)**
```
1. 创建文件:C-x C-f ~/emacs-practice/shopping.txt

2. 输入框架:
========== 购物清单 ==========

========== 预算 ==========

========== 备注 ==========

3. 保存:C-x C-s
```

**第 2 步:添加分类(5分钟)**
```
1. 在第一个分割线下添加:
[ ] 水果
[ ] 蔬菜
[ ] 日用品
[ ] 零食

2. 用矩形插入添加缩进:
   - 选中 4 行的开头(C-SPC)
   - C-x r t
   - 输入 4 个空格
```

**第 3 步:添加具体项目(5分钟)**
```
在每个分类下添加项目:
1. 手动输入或复制粘贴
2. 使用 C-y 和 M-y 复用格式

练习技巧:
- 复制 "    - [ ] " 格式:C-SPC, C-e, M-w
- 粘贴并修改:C-y, 然后输入商品名
```

**第 4 步:窗口对比(3分钟)**
```
1. 水平分割:C-x 2
2. 在下方打开 edit.txt 作为参考:
   C-x o
   C-x C-f edit.txt
3. 对比两个文件的格式
4. 恢复单窗口:C-x 1
```

**第 5 步:搜索替换优化(2分钟)**
```
如果想批量修改格式:
1. M-% 将所有 "[ ]" 替换为 "[x]" (表示已购买)
2. 搜索特定商品:C-s 苹果
```

### ✓ 最终检查
- [ ] 文件结构完整
- [ ] 使用了矩形编辑
- [ ] 使用了复制粘贴
- [ ] 尝试了窗口分割
- [ ] 文件已保存

---

## 进阶挑战

完成以上 10 个练习后,尝试以下挑战:

### 挑战 1:编写代码
```
创建 hello.py:
def greet(name):
    print(f"Hello, {name}!")

if __name__ == "__main__":
    greet("Emacs")

练习:
- 使用 C-M-\ 自动缩进
- 用 M-; 添加注释
- 用 C-x r t 批量添加注释符号
```

### 挑战 2:组织笔记
```
创建 notes.org:
* 待办事项
** TODO 学习 Emacs
** DONE 安装 Emacs

* 学习笔记
** Emacs 快捷键
*** 移动
- C-f/b/n/p
*** 编辑
- C-w/M-w/C-y
```

### 挑战 3:配置 Emacs
```
编辑 ~/.emacs:
;; 显示行号
(global-display-line-numbers-mode 1)

;; 高亮当前行
(global-hl-line-mode 1)

;; 自动匹配括号
(electric-pair-mode 1)

保存后重启 Emacs 查看效果
```

---

## 学习路径建议

### 第 1 周:基础操作
- [ ] 完成练习 1-3
- [ ] 每天用 Emacs 编辑至少一个文件
- [ ] 强迫自己不用鼠标和方向键

### 第 2 周:进阶功能
- [ ] 完成练习 4-7
- [ ] 尝试用 Emacs 写代码
- [ ] 学习快捷键速查表

### 第 3 周:高级技巧
- [ ] 完成练习 8-10
- [ ] 探索 Dired 文件管理
- [ ] 尝试简单配置

### 第 4 周:形成习惯
- [ ] 完全用 Emacs 工作
- [ ] 学习宏录制(C-x ()
- [ ] 探索插件系统

---

## 常见问题

### Q1:按错键怎么办?
**A:** 按 `C-g` 取消当前命令,或 `C-/` 撤销操作。

### Q2:忘记快捷键怎么办?
**A:** 按 `C-h k` 然后按快捷键查看,或 `M-x` 输入命令名。

### Q3:手指疲劳怎么办?
**A:**
1. 交换 Caps Lock 和 Ctrl 键位
2. 休息时做手指操
3. 慢慢来,形成肌肉记忆

### Q4:Emacs 太难了?
**A:**
1. 不要一次学太多,每天 5 个快捷键
2. 打印速查表贴在显示器旁
3. 坚持 2 周就会顺手

---

## 学习资源

- **官方教程:** `C-h t`
- **快捷键速查:** 查看 `02-Emacs快捷键速查表.md`
- **在线练习:** [openvim.com](https://openvim.com/) (Vim 但概念相通)
- **视频教程:** 搜索 "Emacs tutorial for beginners"

---

## 完成证明

当你能顺畅完成以下操作时,说明你已入门:

```
✓ 不假思索地按 C-x C-s 保存
✓ 用 C-f/b/n/p 移动比方向键更快
✓ 能在 3 个窗口间切换编辑
✓ 用 C-s 搜索比 Ctrl+F 更快
✓ 开始嫌弃其他编辑器
✓ 尝试给朋友安利 Emacs
```

**恭喜你成为 Emacs 用户!** 🎉

继续探索:
- `03-Emacs配置入门.md` (如果你创建了)
- `04-Emacs编程实战.md`
- 在实际工作中坚持使用 Emacs

---

**记住:** Emacs 的学习曲线陡峭,但一旦掌握,将终身受益!
