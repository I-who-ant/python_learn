# 游戏开发技术栈全景图

## 🎮 什么是游戏开发?

游戏开发 = **让计算机显示画面 + 处理输入 + 播放声音 + 网络通信**

```
玩家视角:
  看到画面 → 操作角色 → 听到音效 → 与他人互动

技术视角:
  图形渲染 → 输入处理 → 音频系统 → 网络同步
```

---

## 🏗️ 游戏开发的层次结构

### 完整技术栈

```
┌─────────────────────────────────────────┐
│  游戏层 (Game Layer)                     │
│  • 游戏逻辑 (Lua/C#/C++)                 │
│  • 关卡设计                              │
│  • AI 行为                               │
└─────────────────────────────────────────┘
         ↓ 使用
┌─────────────────────────────────────────┐
│  引擎层 (Engine Layer)                   │
│  • 渲染引擎 (Rendering)                  │
│  • 物理引擎 (Physics)                    │
│  • 音频引擎 (Audio)                      │
│  • 动画系统 (Animation)                  │
│  • 脚本系统 (Scripting)                  │
└─────────────────────────────────────────┘
         ↓ 基于
┌─────────────────────────────────────────┐
│  中间层 (Middleware)                     │
│  • 图形API抽象 (Sokol/BGFX)              │
│  • 物理库 (Box2D/Bullet)                 │
│  • 音频库 (OpenAL/FMOD)                  │
└─────────────────────────────────────────┘
         ↓ 调用
┌─────────────────────────────────────────┐
│  平台层 (Platform Layer)                 │
│  • 图形API (OpenGL/Vulkan/DirectX)       │
│  • 操作系统 (Windows/Linux/macOS)        │
│  • 硬件 (GPU/CPU/声卡)                   │
└─────────────────────────────────────────┘
```

---

## 🎨 核心子系统详解

### 1. 图形渲染系统

**作用**: 在屏幕上绘制画面

```
渲染管线:
  3D模型/2D精灵
       ↓
  顶点处理 (Vertex Shader)
       ↓
  光栅化 (Rasterization)
       ↓
  片段着色 (Fragment Shader)
       ↓
  屏幕输出
```

**技术栈**:

| 层次 | 技术 | 说明 |
|------|------|------|
| **底层API** | OpenGL, Vulkan, DirectX, Metal | 与GPU通信 |
| **抽象层** | Sokol, BGFX, SDL2 | 简化API调用 |
| **引擎层** | Unity, Unreal, Soluna | 高级渲染功能 |

**学习路径**:
```
1. 学OpenGL基础 → 画三角形
2. 学着色器(Shader) → 实现光照
3. 学纹理贴图 → 让物体有颜色
4. 学高级技术 → 阴影、后处理
```

### 2. 物理系统

**作用**: 模拟真实世界的物理现象(碰撞、重力、刚体)

```
物理循环:
  检测碰撞
       ↓
  计算响应(反弹/摩擦)
       ↓
  更新位置/速度
       ↓
  通知游戏逻辑
```

**技术栈**:

| 维度 | 2D物理 | 3D物理 |
|------|--------|--------|
| **开源库** | Box2D, Chipmunk | Bullet, PhysX |
| **商业方案** | Unity Physics 2D | Havok, PhysX |

### 3. 音频系统

**作用**: 播放音效和背景音乐

```
音频管线:
  加载音频文件(.wav/.ogg)
       ↓
  混音(Mix多个音源)
       ↓
  3D空间音效(左右耳)
       ↓
  输出到扬声器
```

**技术栈**:

| 类型 | 技术 |
|------|------|
| **底层API** | OpenAL, WASAPI, ALSA |
| **中间件** | FMOD, Wwise |
| **简单库** | SDL_mixer, sokol_audio |

### 4. 输入系统

**作用**: 处理键盘、鼠标、手柄输入

```
输入流程:
  硬件输入
       ↓
  操作系统事件
       ↓
  游戏引擎处理
       ↓
  游戏逻辑响应
```

**技术栈**:
- **跨平台**: SDL2, GLFW, sokol_app
- **专用库**: OIS, DirectInput

### 5. 脚本系统

**作用**: 用脚本语言编写游戏逻辑(无需重新编译)

```
脚本架构:
  C/C++ 引擎
       ↕ 绑定
  Lua/Python/C# 脚本
       ↓
  游戏逻辑(AI/任务/UI)
```

**常用脚本语言**:

| 语言 | 优势 | 游戏引擎 |
|------|------|---------|
| **Lua** | 轻量、快速 | Soluna, 魔兽世界 |
| **C#** | 强大、生态好 | Unity |
| **Python** | 易学 | Godot(可选) |
| **JavaScript** | Web友好 | Cocos2d-x |

### 6. 网络系统

**作用**: 多人游戏的数据同步

```
网络架构:
  客户端1     客户端2
       ↓         ↓
       服务器(skynet)
       ↓         ↓
  数据库    其他服务
```

**技术栈**:

| 类型 | 技术 |
|------|------|
| **协议** | TCP, UDP, WebSocket |
| **框架** | skynet(云风), Photon, Mirror |
| **序列化** | Protobuf, JSON, MessagePack |

---

## 🛠️ 常见技术库分类

### 图形相关

| 库名 | 类型 | 用途 |
|------|------|------|
| **OpenGL** | 图形API | 跨平台3D渲染 |
| **Vulkan** | 图形API | 现代低级API |
| **DirectX** | 图形API | Windows专用 |
| **Sokol** | 抽象层 | 简化图形编程 |
| **BGFX** | 抽象层 | 多后端支持 |

### 窗口/输入

| 库名 | 用途 |
|------|------|
| **SDL2** | 跨平台多媒体库 |
| **GLFW** | OpenGL窗口库 |
| **sokol_app** | Sokol窗口模块 |

### 计算机视觉

| 库名 | 用途 |
|------|------|
| **OpenCV** | 图像处理、计算机视觉 |
| **⚠️ 注意** | **不是游戏开发必需!** |

**OpenCV 的实际用途**:
- 人脸识别(如相机App)
- 图像滤镜(如美颜)
- AR应用(如Snapchat滤镜)
- **不是用来做游戏渲染的!**

### UI库

| 库名 | 类型 |
|------|------|
| **Dear ImGui** | 即时模式GUI(调试用) |
| **RmlUI** | HTML/CSS风格UI |
| **Nuklear** | 轻量即时GUI |

---

## 🎯 游戏引擎对比

### 商业引擎

| 引擎 | 特点 | 适合 |
|------|------|------|
| **Unity** | C#, 2D/3D, 易学 | 独立游戏、手游 |
| **Unreal** | C++, 高画质, 复杂 | 3A大作、次世代 |
| **Godot** | 开源, GDScript, 轻量 | 独立开发者 |

### 自研引擎(云风系列)

| 引擎 | 类型 | 定位 |
|------|------|------|
| **ejoy2d** | 2D | 早期2D引擎(已停止) |
| **Soluna** | 2D | 现代2D引擎 |
| **Ant Engine** | 3D | 类Unity引擎 |
| **skynet** | 服务器 | 游戏服务器框架 |

---

## 📊 技术选型决策树

### 我该学什么?

```
你想做什么类型的游戏?

├─ 2D游戏
│  ├─ 简单原型 → Godot/LÖVE
│  ├─ 手游/发布 → Unity 2D
│  └─ 学习底层 → Soluna源码
│
├─ 3D游戏
│  ├─ 快速开发 → Unity
│  ├─ 高画质 → Unreal
│  └─ 学习底层 → LearnOpenGL
│
├─ 网页游戏
│  ├─ 2D → Phaser.js
│  └─ 3D → Three.js
│
└─ 服务器开发
   ├─ 学习 → skynet源码
   └─ 生产 → Photon/Nakama
```

---

## 🔍 OpenGL vs OpenCV vs OpenAL

### 三个"Open"的区别

| 名称 | 全称                     | 用途         | 游戏中的作用  |
|------|------------------------|------------|---------|
| **OpenGL** | Open Graphics Library  | **3D图形渲染** | ✅ 核心技术  |
| **OpenCV** | Open Computer Vision   | 计算机视觉      |  ⚠️ 不常用 |
| **OpenAL** | Open Audio Library     | 3D音频       | ✅ 音效系统  |

**记忆技巧**:
- **GL** = Graphics(图形) → 画画面
- **CV** = Computer Vision(视觉) → 识别图像
- **AL** = Audio(音频) → 放声音

---

## 🎓 学习建议

### 初学者路径

**阶段1: 理解基础概念**(1-2周)
- 了解游戏循环(Game Loop)
- 理解坐标系统
- 学习基础数学(向量、矩阵)

**阶段2: 图形编程入门**(1-2个月)
- 跟随LearnOpenGL教程
- 用Sokol简化开发
- 画出三角形和纹理

**阶段3: 实践项目**(2-3个月)
- 用Unity做简单2D游戏
- 或用Soluna研究源码
- 完成一个可玩的原型

**阶段4: 深入某个方向**(持续)
- 图形技术(光照、阴影)
- 引擎架构(ECS、多线程)
- 服务器开发(skynet)

### 云风技术路线学习顺序

```
1. Soluna (2D引擎)
   ↓ 简单,适合入门

2. skynet (服务器)
   ↓ 理解Actor模型

3. Ant Engine (3D引擎)
   ↓ 复杂,适合深入
```

---

## 🔗 相关文档

- [云风技术演进史](./02-云风技术演进史.md) - 了解各项目关系
- [图形API详解](./03-图形API详解.md) - OpenGL/Vulkan深入
- [常见技术库介绍](./05-常见技术库介绍.md) - 库的详细用途

---

## 💡 关键要点总结

1. **游戏开发 ≠ 只是写代码**
   - 需要图形、物理、音频、网络等多方面知识

2. **不要混淆相似名称的库**
   - OpenGL(图形) vs OpenCV(视觉) vs OpenAL(音频)

3. **选择合适的工具**
   - 做游戏用Unity/Unreal/Godot
   - 学底层用OpenGL/Vulkan/Soluna源码

4. **循序渐进**
   - 先学2D,再学3D
   - 先用引擎,再研究底层

---

**下一步**: 阅读 [云风技术演进史](./02-云风技术演进史.md) 了解各项目的定位
