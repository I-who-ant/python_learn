# Linux å®¹å™¨æŠ€æœ¯æ·±åº¦å­¦ä¹ è·¯å¾„

> ä» Linux å†…æ ¸åº•å±‚åˆ° Docker/K8s å®¹å™¨ç¼–æ’çš„å®Œæ•´å­¦ä¹ ä½“ç³»

## ğŸ“š å­¦ä¹ è·¯å¾„è®¾è®¡

```
Linux åº•å±‚æŠ€æœ¯ (åŸºç¡€)
    â†“
01. Namespace (å‘½åç©ºé—´éš”ç¦»)
    â†“
02. Cgroups (èµ„æºæ§åˆ¶)
    â†“
03. Chroot (æ–‡ä»¶ç³»ç»Ÿéš”ç¦»)
    â†“
04. Union File System (è”åˆæ–‡ä»¶ç³»ç»Ÿ)
    â†“
05. ç½‘ç»œè™šæ‹ŸåŒ– (veth, bridge, iptables)
    â†“
å®¹å™¨è¿è¡Œæ—¶ (ä¸­çº§)
    â†“
06. æ‰‹åŠ¨æ„å»ºå®¹å™¨ (ä»é›¶å®ç°)
    â†“
07. runc å’Œ containerd
    â†“
08. Docker åŸç†å’Œä½¿ç”¨
    â†“
å®¹å™¨ç¼–æ’ (é«˜çº§)
    â†“
09. Kubernetes æ¶æ„
    â†“
10. K8s å®æˆ˜å’Œè¿ç»´
```

## ğŸ¯ å­¦ä¹ ç›®æ ‡

### åˆçº§ç›®æ ‡
- âœ… ç†è§£å®¹å™¨çš„æœ¬è´¨ï¼ˆå®ƒåªæ˜¯ä¸€ä¸ªè¢«é™åˆ¶çš„è¿›ç¨‹ï¼‰
- âœ… æŒæ¡ Linux å†…æ ¸çš„ä¸‰å¤§éš”ç¦»æŠ€æœ¯
- âœ… èƒ½å¤Ÿæ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªç®€å•çš„å®¹å™¨

### ä¸­çº§ç›®æ ‡
- âœ… æ·±å…¥ç†è§£ Docker çš„å·¥ä½œåŸç†
- âœ… æŒæ¡é•œåƒæ„å»ºå’Œä¼˜åŒ–
- âœ… ç†è§£å®¹å™¨ç½‘ç»œå’Œå­˜å‚¨

### é«˜çº§ç›®æ ‡
- âœ… ç†è§£ Kubernetes æ¶æ„å’ŒåŸç†
- âœ… èƒ½å¤Ÿéƒ¨ç½²å’Œè¿ç»´ K8s é›†ç¾¤
- âœ… æŒæ¡å®¹å™¨å®‰å…¨å’Œæ€§èƒ½ä¼˜åŒ–

## ğŸ“– æ–‡æ¡£åˆ—è¡¨

| åºå· | æ–‡æ¡£åç§° | éš¾åº¦ | æ ¸å¿ƒå†…å®¹ |
|-----|---------|------|---------|
| 00 | [å®¹å™¨æŠ€æœ¯æ€»è§ˆ](./00-å®¹å™¨æŠ€æœ¯æ€»è§ˆ.md) | å…¥é—¨ | ä»€ä¹ˆæ˜¯å®¹å™¨ã€å†å²æ¼”å˜ |
| 01 | [Namespaceè¯¦è§£](./01-Namespaceè¯¦è§£.md) | åŸºç¡€ | 7ç§å‘½åç©ºé—´ã€PID/NET/MNTç­‰ |
| 02 | [Cgroupsè¯¦è§£](./02-Cgroupsè¯¦è§£.md) | åŸºç¡€ | èµ„æºé™åˆ¶ã€CPU/å†…å­˜/IOæ§åˆ¶ |
| 03 | [Chrootè¯¦è§£](./03-Chrootè¯¦è§£.md) | åŸºç¡€ | æ ¹ç›®å½•åˆ‡æ¢ã€æ–‡ä»¶ç³»ç»Ÿéš”ç¦» |
| 04 | [UnionFSè¯¦è§£](./04-UnionFSè¯¦è§£.md) | ä¸­çº§ | OverlayFSã€åˆ†å±‚å­˜å‚¨ |
| 05 | [å®¹å™¨ç½‘ç»œè¯¦è§£](./05-å®¹å™¨ç½‘ç»œè¯¦è§£.md) | ä¸­çº§ | vethã€bridgeã€iptables |
| 06 | [æ‰‹åŠ¨æ„å»ºå®¹å™¨](./06-æ‰‹åŠ¨æ„å»ºå®¹å™¨.md) | ä¸­çº§ | ä»é›¶å®ç°ä¸€ä¸ªå®¹å™¨ |
| 07 | [å®¹å™¨è¿è¡Œæ—¶](./07-å®¹å™¨è¿è¡Œæ—¶.md) | ä¸­çº§ | runcã€containerdã€CRI |
| 08 | [Dockeræ·±å…¥ç†è§£](./08-Dockeræ·±å…¥ç†è§£.md) | ä¸­çº§ | æ¶æ„ã€é•œåƒã€ç½‘ç»œã€å­˜å‚¨ |
| 09 | [Kubernetesæ¶æ„](./09-Kubernetesæ¶æ„.md) | é«˜çº§ | ç»„ä»¶ã€è°ƒåº¦ã€ç½‘ç»œã€å­˜å‚¨ |
| 10 | [K8så®æˆ˜è¿ç»´](./10-K8så®æˆ˜è¿ç»´.md) | é«˜çº§ | éƒ¨ç½²ã€ç›‘æ§ã€æ•…éšœæ’æŸ¥ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ¨èå­¦ä¹ é¡ºåº

#### ç¬¬ä¸€é˜¶æ®µï¼šç†è§£å®¹å™¨æœ¬è´¨ï¼ˆ1-2å‘¨ï¼‰
```bash
# 1. é˜…è¯»æ€»è§ˆï¼Œå»ºç«‹å…¨å±€è®¤çŸ¥
cat 00-å®¹å™¨æŠ€æœ¯æ€»è§ˆ.md

# 2. å­¦ä¹ ä¸‰å¤§æ ¸å¿ƒæŠ€æœ¯
cat 01-Namespaceè¯¦è§£.md
cat 02-Cgroupsè¯¦è§£.md
cat 03-Chrootè¯¦è§£.md

# 3. åŠ¨æ‰‹å®éªŒ
# è·Ÿéšæ–‡æ¡£ä¸­çš„ç¤ºä¾‹ï¼Œäº²è‡ªæ“ä½œæ¯ä¸ªå‘½ä»¤
```

#### ç¬¬äºŒé˜¶æ®µï¼šæ·±å…¥å®¹å™¨åŸç†ï¼ˆ2-3å‘¨ï¼‰
```bash
# 4. å­¦ä¹ æ–‡ä»¶ç³»ç»Ÿå’Œç½‘ç»œ
cat 04-UnionFSè¯¦è§£.md
cat 05-å®¹å™¨ç½‘ç»œè¯¦è§£.md

# 5. æ‰‹åŠ¨æ„å»ºå®¹å™¨ï¼ˆé‡ç‚¹ï¼ï¼‰
cat 06-æ‰‹åŠ¨æ„å»ºå®¹å™¨.md

# 6. ç†è§£å®¹å™¨è¿è¡Œæ—¶
cat 07-å®¹å™¨è¿è¡Œæ—¶.md
```

#### ç¬¬ä¸‰é˜¶æ®µï¼šDocker å®æˆ˜ï¼ˆ2-3å‘¨ï¼‰
```bash
# 7. Docker å®Œæ•´å­¦ä¹ 
cat 08-Dockeræ·±å…¥ç†è§£.md

# 8. å®æˆ˜é¡¹ç›®
# - æ„å»ºé•œåƒ
# - å¤šå®¹å™¨åº”ç”¨
# - ç½‘ç»œå’Œå­˜å‚¨
```

#### ç¬¬å››é˜¶æ®µï¼šKubernetesï¼ˆ4-6å‘¨ï¼‰
```bash
# 9. K8s æ¶æ„ç†è§£
cat 09-Kubernetesæ¶æ„.md

# 10. K8s å®æˆ˜
cat 10-K8så®æˆ˜è¿ç»´.md
```

## ğŸ’¡ å­¦ä¹ å»ºè®®

### 1. å®è·µä¸ºä¸»
- **æ¯ä¸ªå‘½ä»¤éƒ½è¦äº²è‡ªæ‰§è¡Œ**
- **æ¯ä¸ªç¤ºä¾‹éƒ½è¦ç†è§£åŸç†**
- **åŠ¨æ‰‹æ„å»ºè‡ªå·±çš„å®¹å™¨**

### 2. å®‰å…¨ç¯å¢ƒ
```bash
# å»ºè®®ä½¿ç”¨è™šæ‹Ÿæœºæˆ–æµ‹è¯•ç¯å¢ƒ
# é¿å…åœ¨ç”Ÿäº§ç¯å¢ƒå°è¯•
sudo pacman -S virtualbox  # æˆ–ä½¿ç”¨ Docker è‡ªå¸¦çš„ç¯å¢ƒ
```

### 3. å‡†å¤‡å·¥å…·
```bash
# Arch Linux å®‰è£…å¿…è¦å·¥å…·
sudo pacman -S docker docker-compose
sudo pacman -S kubectl helm
sudo pacman -S go  # æŸäº›ç¤ºä¾‹éœ€è¦ Go ç¼–è¯‘

# å¯åŠ¨ Docker
sudo systemctl start docker
sudo systemctl enable docker

# æ·»åŠ ç”¨æˆ·åˆ° docker ç»„
sudo usermod -aG docker $USER
```

### 4. é˜…è¯»æŠ€å·§
- ğŸ“– å…ˆé€šè¯»ä¸€éï¼Œç†è§£æ¦‚å¿µ
- âœï¸ åšç¬”è®°ï¼Œè®°å½•å…³é”®ç‚¹
- ğŸ’» åŠ¨æ‰‹å®éªŒï¼ŒéªŒè¯ç†è§£
- ğŸ”„ å¾ªç¯å­¦ä¹ ï¼Œæ·±å…¥åŸç†

## ğŸ“ æ¯ä¸ªæ–‡æ¡£çš„å­¦ä¹ é‡ç‚¹

### åŸºç¡€ç¯‡ï¼ˆå¿…å­¦ï¼‰
- **01-Namespace**: ç†è§£éš”ç¦»çš„æœ¬è´¨
- **02-Cgroups**: ç†è§£èµ„æºé™åˆ¶
- **03-Chroot**: ç†è§£æ–‡ä»¶ç³»ç»Ÿéš”ç¦»

### è¿›é˜¶ç¯‡ï¼ˆé‡è¦ï¼‰
- **06-æ‰‹åŠ¨æ„å»ºå®¹å™¨**: ğŸŒŸ æœ€é‡è¦ï¼ç†è§£å®¹å™¨å¦‚ä½•å·¥ä½œ
- **08-Dockeræ·±å…¥ç†è§£**: å·¥ä¸šçº§å®¹å™¨å®ç°

### é«˜çº§ç¯‡ï¼ˆæ‰©å±•ï¼‰
- **09-Kubernetesæ¶æ„**: åˆ†å¸ƒå¼å®¹å™¨ç¼–æ’
- **10-K8så®æˆ˜è¿ç»´**: ä¼ä¸šçº§åº”ç”¨

## ğŸ“ æ ¸å¿ƒæ¦‚å¿µé¢„è§ˆ

### ä»€ä¹ˆæ˜¯å®¹å™¨ï¼Ÿ
> **å®¹å™¨ = Namespace + Cgroups + Chroot + UnionFS**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å®¹å™¨è¿›ç¨‹éš”ç¦»è§†å›¾              â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Namespace (å‘½åç©ºé—´)         â”‚  â”‚
â”‚  â”‚  - PID: ç‹¬ç«‹è¿›ç¨‹æ ‘            â”‚  â”‚
â”‚  â”‚  - NET: ç‹¬ç«‹ç½‘ç»œæ ˆ            â”‚  â”‚
â”‚  â”‚  - MNT: ç‹¬ç«‹æŒ‚è½½ç‚¹            â”‚  â”‚
â”‚  â”‚  - IPC: ç‹¬ç«‹é€šä¿¡              â”‚  â”‚
â”‚  â”‚  - UTS: ç‹¬ç«‹ä¸»æœºå            â”‚  â”‚
â”‚  â”‚  - User: ç‹¬ç«‹ç”¨æˆ·             â”‚  â”‚
â”‚  â”‚  - Cgroup: ç‹¬ç«‹èµ„æºè§†å›¾       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Cgroups (èµ„æºæ§åˆ¶)           â”‚  â”‚
â”‚  â”‚  - CPU: é™åˆ¶è®¡ç®—èµ„æº          â”‚  â”‚
â”‚  â”‚  - Memory: é™åˆ¶å†…å­˜ä½¿ç”¨       â”‚  â”‚
â”‚  â”‚  - Disk I/O: é™åˆ¶ç£ç›˜è®¿é—®     â”‚  â”‚
â”‚  â”‚  - Network: é™åˆ¶ç½‘ç»œå¸¦å®½      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Chroot + UnionFS            â”‚  â”‚
â”‚  â”‚  - ç‹¬ç«‹çš„æ ¹æ–‡ä»¶ç³»ç»Ÿ            â”‚  â”‚
â”‚  â”‚  - åˆ†å±‚é•œåƒå­˜å‚¨                â”‚  â”‚
â”‚  â”‚  - å†™æ—¶å¤åˆ¶ (COW)             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®¹å™¨ vs è™šæ‹Ÿæœº

| ç‰¹æ€§ | å®¹å™¨ | è™šæ‹Ÿæœº |
|-----|------|--------|
| å¯åŠ¨é€Ÿåº¦ | ç§’çº§ | åˆ†é’Ÿçº§ |
| èµ„æºå ç”¨ | MB | GB |
| æ€§èƒ½ | æ¥è¿‘åŸç”Ÿ | æœ‰æŸè€— |
| éš”ç¦»æ€§ | è¿›ç¨‹çº§ | æ“ä½œç³»ç»Ÿçº§ |
| ç³»ç»Ÿå†…æ ¸ | å…±äº«å®¿ä¸»æœº | ç‹¬ç«‹å†…æ ¸ |

## ğŸ”§ å®éªŒç¯å¢ƒå‡†å¤‡

### æ£€æŸ¥ç³»ç»Ÿæ”¯æŒ
```bash
# æ£€æŸ¥å†…æ ¸ç‰ˆæœ¬ï¼ˆéœ€è¦ >= 3.10ï¼‰
uname -r

# æ£€æŸ¥ Namespace æ”¯æŒ
ls /proc/$$/ns/

# æ£€æŸ¥ Cgroups ç‰ˆæœ¬
mount | grep cgroup

# æ£€æŸ¥ OverlayFS æ”¯æŒ
cat /proc/filesystems | grep overlay
```

### å®‰è£… Dockerï¼ˆArch Linuxï¼‰
```bash
# å®‰è£… Docker
sudo pacman -S docker docker-compose docker-buildx

# å¯åŠ¨ Docker æœåŠ¡
sudo systemctl start docker
sudo systemctl enable docker

# éªŒè¯å®‰è£…
docker --version
docker run hello-world

# é…ç½®é•œåƒåŠ é€Ÿï¼ˆå¯é€‰ï¼Œå›½å†…ç”¨æˆ·ï¼‰
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<EOF
{
  "registry-mirrors": [
    "https://docker.mirrors.ustc.edu.cn",
    "https://hub-mirror.c.163.com"
  ]
}
EOF
sudo systemctl restart docker
```

## ğŸ“š å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£
- [Docker å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/)
- [Kubernetes å®˜æ–¹æ–‡æ¡£](https://kubernetes.io/docs/)
- [containerd æ–‡æ¡£](https://containerd.io/)
- [Linux Namespace æ‰‹å†Œ](https://man7.org/linux/man-pages/man7/namespaces.7.html)

### æ¨èä¹¦ç±
- ã€ŠDocker æŠ€æœ¯å…¥é—¨ä¸å®æˆ˜ã€‹
- ã€ŠKubernetes æƒå¨æŒ‡å—ã€‹
- ã€Šæ·±å…¥ç†è§£ Linux å†…æ ¸ã€‹

### åœ¨çº¿èµ„æº
- Linux Kernel Documentation
- Docker Blog
- Kubernetes Blog
- CNCF (Cloud Native Computing Foundation)

## âš ï¸ å®‰å…¨æç¤º

### å®¹å™¨å®‰å…¨åŸåˆ™
1. **æœ€å°æƒé™åŸåˆ™**: ä¸è¦ä»¥ root è¿è¡Œå®¹å™¨
2. **é•œåƒå®‰å…¨**: ä½¿ç”¨å®˜æ–¹é•œåƒï¼Œå®šæœŸæ‰«ææ¼æ´
3. **ç½‘ç»œéš”ç¦»**: åˆç†é…ç½®ç½‘ç»œç­–ç•¥
4. **èµ„æºé™åˆ¶**: å§‹ç»ˆè®¾ç½®èµ„æºé™åˆ¶
5. **æ•æ„Ÿä¿¡æ¯**: ä¸è¦åœ¨é•œåƒä¸­ç¡¬ç¼–ç å¯†ç 

### å®éªŒå®‰å…¨
```bash
# ä½¿ç”¨è™šæ‹Ÿæœºæˆ–æµ‹è¯•ç¯å¢ƒ
# ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒå°è¯•å±é™©æ“ä½œ
# å®šæœŸå¤‡ä»½é‡è¦æ•°æ®
```

## ğŸ¯ å­¦ä¹ æ£€æŸ¥æ¸…å•

### åŸºç¡€çŸ¥è¯†
- [ ] ç†è§£ä»€ä¹ˆæ˜¯å®¹å™¨
- [ ] æŒæ¡ Namespace çš„ 7 ç§ç±»å‹
- [ ] æŒæ¡ Cgroups èµ„æºé™åˆ¶
- [ ] ç†è§£ Chroot æ–‡ä»¶ç³»ç»Ÿéš”ç¦»
- [ ] ç†è§£åˆ†å±‚æ–‡ä»¶ç³»ç»ŸåŸç†

### å®è·µèƒ½åŠ›
- [ ] èƒ½å¤Ÿæ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªç®€å•å®¹å™¨
- [ ] èƒ½å¤Ÿç¼–å†™ Dockerfile
- [ ] èƒ½å¤Ÿä½¿ç”¨ Docker Compose
- [ ] èƒ½å¤Ÿéƒ¨ç½² K8s é›†ç¾¤
- [ ] èƒ½å¤Ÿæ’æŸ¥å®¹å™¨é—®é¢˜

### è¿›é˜¶ç›®æ ‡
- [ ] ç†è§£å®¹å™¨ç½‘ç»œåŸç†
- [ ] ç†è§£å®¹å™¨å­˜å‚¨åŸç†
- [ ] æŒæ¡é•œåƒä¼˜åŒ–æŠ€å·§
- [ ] æŒæ¡ K8s è°ƒåº¦ç­–ç•¥
- [ ] æŒæ¡å®¹å™¨å®‰å…¨æœ€ä½³å®è·µ

---

## ğŸš€ å¼€å§‹å­¦ä¹ 

å‡†å¤‡å¥½äº†å—ï¼Ÿä» [00-å®¹å™¨æŠ€æœ¯æ€»è§ˆ](./00-å®¹å™¨æŠ€æœ¯æ€»è§ˆ.md) å¼€å§‹ä½ çš„å®¹å™¨æŠ€æœ¯å­¦ä¹ ä¹‹æ—…ï¼

**è®°ä½**ï¼šå®¹å™¨ä¸æ˜¯é­”æ³•ï¼Œå®ƒåªæ˜¯ Linux å†…æ ¸åŠŸèƒ½çš„å·§å¦™ç»„åˆï¼ç†è§£åº•å±‚åŸç†ï¼Œä½ å°±èƒ½çœŸæ­£æŒæ¡å®¹å™¨æŠ€æœ¯ï¼

---

*æ›´æ–°æ—¥æœŸ: 2025-12-02*
*é€‚ç”¨ç³»ç»Ÿ: Arch Linux (Kernel 6.17.9-zen1-1-zen)*
