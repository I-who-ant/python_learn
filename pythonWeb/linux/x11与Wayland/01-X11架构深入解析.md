# X11 æ¶æ„æ·±å…¥è§£æ - ä»é›¶ç†è§£ X Window System

## ğŸ¯ X11 çš„æ ¸å¿ƒå“²å­¦

X11 è¯ç”Ÿäº 1984 å¹´,æ ¸å¿ƒè®¾è®¡ç†å¿µæ˜¯:

```
"æœºåˆ¶è€Œéç­–ç•¥"(Mechanism, not policy)

X11 æä¾›åº•å±‚æœºåˆ¶ (å¦‚ç»˜åˆ¶çª—å£ã€å¤„ç†è¾“å…¥)
ä½†ä¸è§„å®šç­–ç•¥ (å¦‚çª—å£å¦‚ä½•è£…é¥°ã€èœå•å¦‚ä½•æ˜¾ç¤º)

ç±»æ¯”:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
X11                          é“è·¯ç³»ç»Ÿ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æä¾›:ç»˜å›¾ã€è¾“å…¥ã€çª—å£         æä¾›:é“è·¯ã€çº¢ç»¿ç¯
ä¸ç®¡:UIé£æ ¼ã€äº¤äº’é€»è¾‘         ä¸ç®¡:æ±½è½¦æ ·å¼ã€é©¾é©¶æ–¹å¼
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

---

## ğŸ›ï¸ X11 å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¨¡å‹

### æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·ç©ºé—´                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ X11 å®¢æˆ·ç«¯ A   â”‚  â”‚ X11 å®¢æˆ·ç«¯ B   â”‚  â”‚ çª—å£ç®¡ç†å™¨   â”‚ â”‚
â”‚  â”‚  (Firefox)    â”‚  â”‚  (Terminal)   â”‚  â”‚   (i3)      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          â”‚                  â”‚                  â”‚         â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                             â”‚                            â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚                    â”‚   X11 Server    â”‚                   â”‚
â”‚                    â”‚     (Xorg)      â”‚                   â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   æ˜¾å¡é©±åŠ¨/å†…æ ¸    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                         â”‚   æ˜¾ç¤ºå™¨  â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®æ¦‚å¿µ

#### 1. X Server (X æœåŠ¡å™¨)

**ä½œç”¨**: ç®¡ç†ç¡¬ä»¶èµ„æº (æ˜¾ç¤ºå™¨ã€é”®ç›˜ã€é¼ æ ‡)

**èŒè´£**:
- æ§åˆ¶å±å¹• (å¸§ç¼“å†²åŒº)
- æ¥æ”¶è¾“å…¥äº‹ä»¶ (é”®ç›˜ã€é¼ æ ‡)
- ç®¡ç†çª—å£å±‚æ¬¡ç»“æ„
- å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚

**å®ç°**: Xorg (æœ€æµè¡Œ), XFree86 (å·²åºŸå¼ƒ)

#### 2. X Client (X å®¢æˆ·ç«¯)

**ä½œç”¨**: éœ€è¦æ˜¾ç¤ºç•Œé¢çš„åº”ç”¨ç¨‹åº

**ç¤ºä¾‹**:
- Firefox (æµè§ˆå™¨)
- GNOME Terminal (ç»ˆç«¯)
- GIMP (å›¾åƒç¼–è¾‘å™¨)

**ç‰¹ç‚¹**:
- ä¸ç›´æ¥æ“ä½œå±å¹•
- é€šè¿‡ X11 åè®®ä¸ X Server é€šä¿¡
- å¯ä»¥è¿è¡Œåœ¨è¿œç¨‹æœºå™¨ä¸Š (ç½‘ç»œé€æ˜!)

#### 3. Window Manager (çª—å£ç®¡ç†å™¨)

**ä½œç”¨**: æ§åˆ¶çª—å£çš„å¤–è§‚å’Œè¡Œä¸º

**èŒè´£**:
- å†³å®šçª—å£ä½ç½®å’Œå¤§å°
- æ·»åŠ çª—å£è£…é¥° (æ ‡é¢˜æ ã€è¾¹æ¡†ã€æŒ‰é’®)
- å¤„ç†çª—å£åˆ‡æ¢ (Alt+Tab)
- ç®¡ç†è™šæ‹Ÿæ¡Œé¢

**ç¤ºä¾‹**:
- i3 (å¹³é“ºå¼)
- Openbox (æµ®åŠ¨å¼)
- Mutter (GNOME çš„çª—å£ç®¡ç†å™¨)

**ç‰¹æ®Šä¹‹å¤„**: çª—å£ç®¡ç†å™¨**ä¹Ÿæ˜¯**ä¸€ä¸ª X å®¢æˆ·ç«¯!

---

## ğŸ” X11 æ ¸å¿ƒæ¦‚å¿µè¯¦è§£

### 1. Display (æ˜¾ç¤ºå™¨è¿æ¥)

```c
// Xlib ä»£ç ç¤ºä¾‹
Display* display = XOpenDisplay(NULL);
// NULL è¡¨ç¤ºä½¿ç”¨ç¯å¢ƒå˜é‡ DISPLAY (å¦‚ ":0")
```

**Display æ˜¯ä»€ä¹ˆ?**
- X11 å®¢æˆ·ç«¯ä¸ X Server çš„è¿æ¥
- ç±»ä¼¼äºæ•°æ®åº“è¿æ¥æˆ–ç½‘ç»œ socket
- åŒ…å«äº†å±å¹•ã€çª—å£ç­‰èµ„æºçš„å¼•ç”¨

**DISPLAY ç¯å¢ƒå˜é‡**:
```bash
# æœ¬åœ°æ˜¾ç¤ºå™¨ (ç¬¬ä¸€ä¸ª X Server)
DISPLAY=:0

# è¿œç¨‹æ˜¾ç¤ºå™¨ (SSH X11 è½¬å‘)
DISPLAY=localhost:10.0

# æ ¼å¼: hostname:displaynumber.screennumber
```

### 2. Screen (å±å¹•)

```c
int screen_num = DefaultScreen(display);
Screen* screen = ScreenOfDisplay(display, screen_num);
```

**Screen æ˜¯ä»€ä¹ˆ?**
- ç‰©ç†æˆ–è™šæ‹Ÿæ˜¾ç¤ºè®¾å¤‡
- ä¸€ä¸ª Display å¯ä»¥æœ‰å¤šä¸ª Screen (å¤šæ˜¾ç¤ºå™¨)
- åŒ…å«å±å¹•å°ºå¯¸ã€é¢œè‰²æ·±åº¦ç­‰ä¿¡æ¯

**ç¤ºä¾‹**:
```
Display :0
  â”œâ”€â”€ Screen 0 (ä¸»æ˜¾ç¤ºå™¨ 1920x1080)
  â””â”€â”€ Screen 1 (å‰¯æ˜¾ç¤ºå™¨ 1280x720)
```

### 3. Window (çª—å£)

```c
// åˆ›å»ºçª—å£
Window win = XCreateWindow(
    display,                // Display è¿æ¥
    DefaultRootWindow(display), // çˆ¶çª—å£ (æ ¹çª—å£)
    100, 100,               // ä½ç½® (x, y)
    800, 600,               // å¤§å° (width, height)
    0,                      // è¾¹æ¡†å®½åº¦
    CopyFromParent,         // é¢œè‰²æ·±åº¦
    InputOutput,            // çª—å£ç±»åˆ«
    CopyFromParent,         // Visual
    0, NULL                 // å±æ€§
);
```

**Window çš„å±‚æ¬¡ç»“æ„**:
```
Root Window (å±å¹•çš„æ ¹çª—å£,è¦†ç›–æ•´ä¸ªå±å¹•)
  â”œâ”€â”€ Firefox ä¸»çª—å£
  â”‚   â”œâ”€â”€ æ ‡ç­¾é¡µ 1
  â”‚   â”œâ”€â”€ æ ‡ç­¾é¡µ 2
  â”‚   â””â”€â”€ åœ°å€æ 
  â”œâ”€â”€ Terminal çª—å£
  â””â”€â”€ çª—å£ç®¡ç†å™¨çš„è£…é¥°çª—å£
```

**Window ID**:
- æ¯ä¸ªçª—å£éƒ½æœ‰å”¯ä¸€çš„ ID (32 ä½æ•´æ•°)
- å¯ä»¥ç”¨ `xwininfo` æˆ– `xdotool` æŸ¥è¯¢

```bash
# ç‚¹å‡»çª—å£æŸ¥çœ‹ä¿¡æ¯
xwininfo

# è¾“å‡º:
# xwininfo: Window id: 0x3200001 "Firefox"
```

### 4. Graphics Context (GC,å›¾å½¢ä¸Šä¸‹æ–‡)

```c
GC gc = XCreateGC(display, win, 0, NULL);

// è®¾ç½®å‰æ™¯è‰² (ç»˜å›¾é¢œè‰²)
XSetForeground(display, gc, WhitePixel(display, screen_num));

// ç»˜åˆ¶çŸ©å½¢
XFillRectangle(display, win, gc, 50, 50, 200, 100);
```

**GC æ˜¯ä»€ä¹ˆ?**
- å­˜å‚¨ç»˜å›¾å‚æ•° (é¢œè‰²ã€çº¿æ¡å®½åº¦ã€å­—ä½“ç­‰)
- ç±»ä¼¼äºç”»ç¬”çš„å±æ€§
- å¤ç”¨ GC å¯ä»¥æé«˜æ€§èƒ½

### 5. Atom (åŸå­)

```c
// Atom æ˜¯å­—ç¬¦ä¸²çš„æ•´æ•°è¡¨ç¤º
Atom atom = XInternAtom(display, "WM_DELETE_WINDOW", False);

// è®¾ç½®çª—å£å±æ€§
XSetWMProtocols(display, win, &atom, 1);
```

**Atom æ˜¯ä»€ä¹ˆ?**
- å­—ç¬¦ä¸²çš„å”¯ä¸€æ•´æ•° ID
- ç”¨äºé«˜æ•ˆä¼ è¾“å­—ç¬¦ä¸² (å‡å°‘ç½‘ç»œå¼€é”€)
- ç±»ä¼¼äºç¬¦å·è¡¨æˆ–å­—ç¬¦ä¸²æ± 

**å¸¸è§ Atom**:
- `WM_DELETE_WINDOW` - çª—å£å…³é—­è¯·æ±‚
- `WM_PROTOCOLS` - çª—å£ç®¡ç†å™¨åè®®
- `_NET_WM_NAME` - çª—å£æ ‡é¢˜

---

## ğŸ“¡ X11 åè®®é€šä¿¡åŸç†

### X11 åè®®æ˜¯äºŒè¿›åˆ¶åè®®

```
å®¢æˆ·ç«¯                               æœåŠ¡å™¨
  â†“                                   â†“
XCreateWindow() â†’ [è¯·æ±‚åŒ…] â†’ Xorg åˆ›å»ºçª—å£
                   â†“
              [4 å­—èŠ‚ opcode: 1]     (CreateWindow æ“ä½œç )
              [4 å­—èŠ‚ window ID]     (æ–°çª—å£ ID)
              [4 å­—èŠ‚ parent ID]     (çˆ¶çª—å£ ID)
              [2 å­—èŠ‚ x, y]          (ä½ç½®)
              [2 å­—èŠ‚ width, height] (å¤§å°)
              ... (æ›´å¤šå‚æ•°)
```

### ç½‘ç»œé€æ˜æ€§

**X11 çš„æ€æ‰‹çº§ç‰¹æ€§**: å¯ä»¥é€šè¿‡ç½‘ç»œæ˜¾ç¤ºè¿œç¨‹åº”ç”¨!

```
è¿œç¨‹æœºå™¨ (æœåŠ¡å™¨)         æœ¬åœ°æœºå™¨ (ä½ çš„ç”µè„‘)
  â†“                         â†“
è¿è¡Œ Firefox (X Client)     è¿è¡Œ Xorg (X Server)
  â†“                         â†“
é€šè¿‡ SSH è¿æ¥               â†“
  â””â”€â”€â”€â”€â”€â”€ X11 åè®® â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                        æ˜¾ç¤º Firefox çª—å£
```

**å®é™…æ“ä½œ**:
```bash
# åœ¨è¿œç¨‹æœºå™¨ä¸Š
ssh -X user@remote-server
firefox &  # Firefox çª—å£ä¼šæ˜¾ç¤ºåœ¨ä½ çš„æœ¬åœ°ç”µè„‘ä¸Š!
```

**ä¸ºä»€ä¹ˆå«"ç½‘ç»œé€æ˜"?**
- åº”ç”¨ç¨‹åº**ä¸çŸ¥é“**å®ƒæ˜¯æœ¬åœ°è¿˜æ˜¯è¿œç¨‹æ˜¾ç¤º
- ä½¿ç”¨ç›¸åŒçš„ X11 API
- å¯¹å¼€å‘è€…å®Œå…¨é€æ˜

---

## ğŸ¬ å®Œæ•´ç¤ºä¾‹:åˆ›å»ºä¸€ä¸ªç®€å•çª—å£

### ä»£ç åˆ†æ

```c
#include <X11/Xlib.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main() {
    // ========================================
    // ç¬¬ 1 æ­¥: è¿æ¥åˆ° X Server
    // ========================================
    Display* display = XOpenDisplay(NULL);
    if (display == NULL) {
        fprintf(stderr, "æ— æ³•æ‰“å¼€ Display\n");
        return 1;
    }

    // ========================================
    // ç¬¬ 2 æ­¥: è·å–é»˜è®¤å±å¹•
    // ========================================
    int screen = DefaultScreen(display);
    Window root = DefaultRootWindow(display);

    // ========================================
    // ç¬¬ 3 æ­¥: åˆ›å»ºçª—å£
    // ========================================
    Window win = XCreateSimpleWindow(
        display,            // Display è¿æ¥
        root,               // çˆ¶çª—å£ (æ ¹çª—å£)
        100, 100,           // ä½ç½® (x, y)
        800, 600,           // å¤§å° (width, height)
        1,                  // è¾¹æ¡†å®½åº¦
        BlackPixel(display, screen),  // è¾¹æ¡†é¢œè‰²
        WhitePixel(display, screen)   // èƒŒæ™¯é¢œè‰²
    );

    // ========================================
    // ç¬¬ 4 æ­¥: è®¾ç½®çª—å£æ ‡é¢˜
    // ========================================
    XStoreName(display, win, "æˆ‘çš„ç¬¬ä¸€ä¸ª X11 çª—å£");

    // ========================================
    // ç¬¬ 5 æ­¥: é€‰æ‹©æ„Ÿå…´è¶£çš„äº‹ä»¶
    // ========================================
    // ç±»ä¼¼äº RGFW çš„äº‹ä»¶ç³»ç»Ÿ!
    XSelectInput(display, win, ExposureMask | KeyPressMask);

    // ========================================
    // ç¬¬ 6 æ­¥: æ˜¾ç¤ºçª—å£
    // ========================================
    XMapWindow(display, win);

    // ========================================
    // ç¬¬ 7 æ­¥: äº‹ä»¶å¾ªç¯
    // ========================================
    XEvent event;
    while (1) {
        XNextEvent(display, &event);  // ç­‰å¾…äº‹ä»¶ (é˜»å¡)

        switch (event.type) {
            case Expose:
                // çª—å£éœ€è¦é‡ç»˜
                printf("çª—å£éœ€è¦é‡ç»˜\n");
                break;

            case KeyPress:
                // æŒ‰é”®äº‹ä»¶
                printf("æŒ‰é”®æŒ‰ä¸‹: keycode=%d\n", event.xkey.keycode);
                if (event.xkey.keycode == 9) { // ESC é”®
                    goto cleanup;
                }
                break;
        }
    }

cleanup:
    // ========================================
    // ç¬¬ 8 æ­¥: æ¸…ç†èµ„æº
    // ========================================
    XDestroyWindow(display, win);
    XCloseDisplay(display);

    return 0;
}
```

**ç¼–è¯‘è¿è¡Œ**:
```bash
gcc -o x11_demo x11_demo.c -lX11
./x11_demo
```

---

## ğŸ”„ ä¸ RGFW å’Œ crepl çš„å¯¹æ¯”

### äº‹ä»¶å¾ªç¯å¯¹æ¯”

```c
// ========================================
// X11 åŸå§‹äº‹ä»¶å¾ªç¯
// ========================================
XEvent event;
while (1) {
    XNextEvent(display, &event);
    switch (event.type) {
        case KeyPress:
            // å¤„ç†æŒ‰é”®
            break;
        case Expose:
            // å¤„ç†é‡ç»˜
            break;
    }
}

// ========================================
// RGFW äº‹ä»¶å¾ªç¯
// ========================================
RGFW_event event;
while (RGFW_window_shouldClose(win) == RGFW_FALSE) {
    while (RGFW_window_checkEvent(win, &event)) {
        switch (event.type) {
            case RGFW_keyPressed:
                // å¤„ç†æŒ‰é”®
                break;
            case RGFW_quit:
                // å¤„ç†é€€å‡º
                break;
        }
    }
}

// ========================================
// crepl çš„ Token å¾ªç¯
// ========================================
while (stb_c_lexer_get_token(&l)) {
    switch (l.token) {
        case CLEX_id:
            // å¤„ç†æ ‡è¯†ç¬¦
            break;
        case CLEX_intlit:
            // å¤„ç†æ•´æ•°
            break;
    }
}
```

**æ¨¡å¼æ€»ç»“**:
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç³»ç»Ÿ          è·å–è¾“å…¥         å¤„ç†è¾“å…¥         åº”ç”¨
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
X11           XNextEvent()     switch(type)     çª—å£ç¨‹åº
RGFW          checkEvent()     switch(type)     è·¨å¹³å°çª—å£
crepl         get_token()      switch(token)    REPL
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ ¸å¿ƒæ€æƒ³: äº‹ä»¶é©±åŠ¨ç¼–ç¨‹ (Event-Driven Programming)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

---

## ğŸ¨ X11 çš„æ‰©å±•æœºåˆ¶

X11 é€šè¿‡**æ‰©å±• (Extensions)** æ·»åŠ æ–°åŠŸèƒ½,è€Œä¸ä¿®æ”¹æ ¸å¿ƒåè®®ã€‚

### å¸¸è§æ‰©å±•

| æ‰©å±•å | åŠŸèƒ½ | ç¤ºä¾‹åº”ç”¨ |
|--------|------|----------|
| **Xrandr** | åˆ†è¾¨ç‡å’Œå¤šæ˜¾ç¤ºå™¨ç®¡ç† | `xrandr` å‘½ä»¤ |
| **XInput** | å¤šç‚¹è§¦æ§ã€ç»˜å›¾æ¿æ”¯æŒ | è§¦æ‘¸å±åº”ç”¨ |
| **XRENDER** | æŠ—é”¯é½¿å’Œé€æ˜åº¦æ¸²æŸ“ | åˆæˆå™¨ (Compton) |
| **GLX** | OpenGL é›†æˆ | æ¸¸æˆã€3D åº”ç”¨ |
| **MIT-SHM** | å…±äº«å†…å­˜åŠ é€Ÿ | é«˜æ€§èƒ½å›¾å½¢ |
| **XFIXES** | å…‰æ ‡å’ŒåŒºåŸŸæ“ä½œ | å±å¹•å½•åˆ¶ |

### æŸ¥è¯¢æ‰©å±•

```bash
xdpyinfo | grep "number of extensions"
# è¾“å‡º: number of extensions:    31

xdpyinfo | grep -A 30 "extensions:"
# åˆ—å‡ºæ‰€æœ‰å¯ç”¨æ‰©å±•
```

---

## ğŸ”§ X11 çš„å·¥å…·ç”Ÿæ€

### è°ƒè¯•å’Œä¿¡æ¯å·¥å…·

```bash
# æ˜¾ç¤º Display ä¿¡æ¯
xdpyinfo

# æŸ¥çœ‹çª—å£ä¿¡æ¯ (ç‚¹å‡»çª—å£)
xwininfo

# æŸ¥çœ‹çª—å£å±æ€§
xprop

# åˆ—å‡ºæ‰€æœ‰çª—å£
xwininfo -root -tree

# ç›‘æ§ X11 äº‹ä»¶
xev  # æ‰“å¼€çª—å£,ç§»åŠ¨é¼ æ ‡æˆ–æŒ‰é”®æŸ¥çœ‹äº‹ä»¶
```

### çª—å£æ“ä½œå·¥å…·

```bash
# æˆªå›¾
import screenshot.png  # ç‚¹å‡»çª—å£

# æ“ä½œçª—å£ (éœ€è¦ xdotool)
xdotool search --name "Firefox" windowactivate  # æ¿€æ´» Firefox
xdotool key ctrl+l  # å‘é€ Ctrl+L æŒ‰é”®
```

---

## ğŸ—ï¸ X11 çš„é—®é¢˜å’Œé™åˆ¶

### 1. å®‰å…¨é—®é¢˜

```c
// ä»»ä½• X å®¢æˆ·ç«¯éƒ½å¯ä»¥ç›‘å¬å…¶ä»–çª—å£çš„è¾“å…¥!
XSelectInput(display, any_window, KeyPressMask);
// è¿™æ„å‘³ç€æ¶æ„ç¨‹åºå¯ä»¥è®°å½•ä½ çš„å¯†ç !
```

### 2. æ€§èƒ½é—®é¢˜

```
åº”ç”¨ç»˜å›¾ â†’ X Server å¤åˆ¶ â†’ çª—å£ç®¡ç†å™¨å¤åˆ¶ â†’ åˆæˆå™¨åˆæˆ â†’ æ˜¾ç¤º

é—®é¢˜: æ•°æ®è¢«å¤åˆ¶å¤šæ¬¡,å»¶è¿Ÿé«˜,GPU åˆ©ç”¨ç‡ä½
```

### 3. æ¶æ„å¤æ‚

```bash
# Xorg çš„ä»£ç è¡Œæ•°
wc -l /usr/bin/Xorg
# æ•°ç™¾ä¸‡è¡Œä»£ç ,åŒ…å« 40 å¹´çš„å†å²åŒ…è¢±
```

### 4. HiDPI æ”¯æŒå·®

```bash
# X11 éœ€è¦æ‰‹åŠ¨è®¾ç½® DPI
xrandr --dpi 192

# åº”ç”¨éœ€è¦å„è‡ªå¤„ç†ç¼©æ”¾,ä¸ä¸€è‡´
```

---

## ğŸ“ å…³é”®æ¦‚å¿µæ€»ç»“

### X11 çš„æ ¸å¿ƒç‰¹ç‚¹

```
âœ… ç½‘ç»œé€æ˜ (å¯è¿œç¨‹æ˜¾ç¤º)
âœ… æ¨¡å—åŒ–è®¾è®¡ (çª—å£ç®¡ç†å™¨å¯æ›¿æ¢)
âœ… æˆç†Ÿç¨³å®š (40 å¹´å†å²)
âœ… ä¸°å¯Œçš„æ‰©å±•æœºåˆ¶

âŒ å®‰å…¨æ€§å·® (çª—å£é—´æ— éš”ç¦»)
âŒ æ€§èƒ½å¼€é”€å¤§ (å¤šæ¬¡æ•°æ®å¤åˆ¶)
âŒ ä»£ç å¤æ‚ (å†å²åŒ…è¢±)
âŒ ç°ä»£åŒ–åŠŸèƒ½æ”¯æŒå·® (HiDPI, è§¦æ‘¸ç­‰)
```

### X11 vs RGFW

```c
// X11: ç›´æ¥ä½¿ç”¨ Xlib (å¤æ‚)
Display* display = XOpenDisplay(NULL);
Window win = XCreateWindow(display, ...);
XSelectInput(display, win, ExposureMask | KeyPressMask);
XMapWindow(display, win);
while (1) {
    XNextEvent(display, &event);
    // å¤„ç†äº‹ä»¶...
}

// RGFW: è·¨å¹³å°æŠ½è±¡ (ç®€å•)
RGFW_window* win = RGFW_createWindow("Title", 0, 0, 800, 600, 0);
while (!RGFW_window_shouldClose(win)) {
    while (RGFW_window_checkEvent(win, &event)) {
        // å¤„ç†äº‹ä»¶...
    }
}
```

---

## ğŸ“š ä¸‹ä¸€æ­¥

é˜…è¯»ä¸‹ä¸€ç¯‡æ–‡æ¡£: **02-Waylandæ¶æ„æ·±å…¥è§£æ.md**

åœ¨é‚£é‡Œä½ ä¼šå­¦åˆ°:
- Wayland å¦‚ä½•è§£å†³ X11 çš„é—®é¢˜
- Wayland çš„åˆæˆå™¨å³æœåŠ¡å™¨æ¨¡å‹
- Wayland åè®®çš„ç°ä»£åŒ–è®¾è®¡
- ä¸ºä»€ä¹ˆ Wayland æ€§èƒ½æ›´å¥½ä½†ç”Ÿæ€å°šæœªå®Œå…¨æˆç†Ÿ

---

## ğŸ”— å‚è€ƒèµ„æº

- [X11 å®˜æ–¹æ–‡æ¡£](https://www.x.org/wiki/)
- [Xlib ç¼–ç¨‹æ‰‹å†Œ](https://tronche.com/gui/x/xlib/)
- [X11 åè®®è§„èŒƒ](https://www.x.org/releases/X11R7.7/doc/xproto/x11protocol.html)
- [Arch Wiki - Xorg](https://wiki.archlinux.org/title/Xorg)

---

**ä½ ç°åœ¨åº”è¯¥ç†è§£äº†**:
- âœ… X11 çš„å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¨¡å‹
- âœ… Displayã€Screenã€Window ç­‰æ ¸å¿ƒæ¦‚å¿µ
- âœ… X11 åè®®çš„ç½‘ç»œé€æ˜æ€§
- âœ… X11 äº‹ä»¶å¾ªç¯ä¸ RGFWã€crepl çš„ç›¸ä¼¼ä¹‹å¤„
- âœ… X11 çš„ä¼˜ç‚¹å’Œå±€é™æ€§
