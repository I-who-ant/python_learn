# K3s

> 轻量级 Kubernetes、边缘计算、快速部署

## 概述

K3s 是 Rancher 推出的轻量级 Kubernetes 发行版,适用于边缘计算、IoT、CI/CD 等资源受限场景。

## 特点

**优势**:
- 单二进制文件(< 100MB)
- 内存占用小(512MB可运行)
- 内置功能完整(Ingress、DNS等)
- 一键安装
- 自动 TLS 证书

**适用场景**:
- 边缘计算
- IoT 设备
- ARM 设备
- CI/CD 环境
- 开发测试

## 快速安装

### 单节点安装

\`\`\`bash
# 安装 K3s Server
curl -sfL https://get.k3s.io | sh -

# 查看状态
systemctl status k3s

# 查看节点
k3s kubectl get nodes

# 配置 kubectl
export KUBECONFIG=/etc/rancher/k3s/k3s.yaml
\`\`\`

### 多节点集群

\`\`\`bash
# Server 节点
curl -sfL https://get.k3s.io | sh -s - server --cluster-init

# 获取 token
cat /var/lib/rancher/k3s/server/node-token

# Agent 节点
curl -sfL https://get.k3s.io | K3S_URL=https://server:6443 K3S_TOKEN=<token> sh -
\`\`\`

### 高可用安装

\`\`\`bash
# 外部数据库模式(使用 MySQL/PostgreSQL)
curl -sfL https://get.k3s.io | sh -s - server \
  --datastore-endpoint="mysql://user:pass@tcp(host:3306)/k3s"

# 嵌入式 etcd 模式
curl -sfL https://get.k3s.io | sh -s - server --cluster-init
\`\`\`

## 配置选项

\`\`\`bash
# 禁用组件
curl -sfL https://get.k3s.io | sh -s - --disable traefik --disable servicelb

# 指定数据目录
curl -sfL https://get.k3s.io | sh -s - --data-dir /data/k3s

# 配置镜像仓库
cat > /etc/rancher/k3s/registries.yaml << EOF
mirrors:
  docker.io:
    endpoint:
      - "https://registry.cn-hangzhou.aliyuncs.com"
EOF
\`\`\`

## 卸载

\`\`\`bash
# Server 节点
/usr/local/bin/k3s-uninstall.sh

# Agent 节点
/usr/local/bin/k3s-agent-uninstall.sh
\`\`\`

## 参考资源

- [K3s 官方文档](https://docs.k3s.io/)

---

*更新日期: 2025-12-03*
