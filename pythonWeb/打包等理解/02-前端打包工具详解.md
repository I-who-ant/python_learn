# å‰ç«¯æ‰“åŒ…å·¥å…·è¯¦è§£

## æ¦‚è¿°

æœ¬æ–‡æ¡£æ·±å…¥è®²è§£ä¸»æµå‰ç«¯æ‰“åŒ…å·¥å…·çš„å·¥ä½œåŸç†å’Œå¯¹æ¯”,åŒ…æ‹¬:
- Webpack (æœ€æˆç†Ÿã€æœ€å¼ºå¤§)
- Vite (æœ€å¿«ã€æœ€ç°ä»£)
- Rollup (åº“æ‰“åŒ…ä¸“å®¶)
- Parcel (é›¶é…ç½®)

---

## Webpack è¯¦è§£

### æ ¸å¿ƒæ¦‚å¿µ

**Webpack** = æ¨¡å—æ‰“åŒ…å·¥å…· (Module Bundler)

**è®¾è®¡ç†å¿µ**:
> "Everything is a module"
> (ä¸€åˆ‡éƒ½æ˜¯æ¨¡å—)

ä¸ä»… JavaScript,CSSã€å›¾ç‰‡ã€å­—ä½“éƒ½å¯ä»¥è¢«è§†ä¸ºæ¨¡å—ã€‚

### äº”å¤§æ ¸å¿ƒæ¦‚å¿µ

#### 1. Entry (å…¥å£)

**å®šä¹‰**:æ‰“åŒ…çš„èµ·ç‚¹,Webpack ä»è¿™é‡Œå¼€å§‹æ„å»ºä¾èµ–å›¾ã€‚

```javascript
// webpack.config.js
module.exports = {
  entry: './src/main.js'  // å•å…¥å£
}
```

**å¤šå…¥å£**:
```javascript
module.exports = {
  entry: {
    app: './src/app.js',
    admin: './src/admin.js'
  }
  // ç”Ÿæˆä¸¤ä¸ªç‹¬ç«‹çš„ bundle
}
```

#### 2. Output (è¾“å‡º)

**å®šä¹‰**:æ‰“åŒ…åæ–‡ä»¶çš„è¾“å‡ºä½ç½®å’Œå‘½åè§„åˆ™ã€‚

```javascript
module.exports = {
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: '[name].[contenthash].js',
    clean: true  // æ¸…ç†æ—§æ–‡ä»¶
  }
}
```

**å ä½ç¬¦**:
- `[name]`:å…¥å£åç§° (appã€admin)
- `[contenthash]`:å†…å®¹å“ˆå¸Œå€¼ (ç¼“å­˜ä¼˜åŒ–)
- `[id]`:æ¨¡å— ID

#### 3. Loader (åŠ è½½å™¨)

**å®šä¹‰**:è½¬æ¢é JavaScript æ–‡ä»¶ä¸º Webpack èƒ½å¤„ç†çš„æ¨¡å—ã€‚

**åŸç†**:
```
.vue æ–‡ä»¶ â†’ vue-loader â†’ JavaScript æ¨¡å—
.scss æ–‡ä»¶ â†’ sass-loader â†’ css-loader â†’ style-loader â†’ æµè§ˆå™¨
.ts æ–‡ä»¶ â†’ ts-loader â†’ JavaScript æ¨¡å—
```

**é…ç½®ç¤ºä¾‹**:
```javascript
module.exports = {
  module: {
    rules: [
      // å¤„ç† Vue å•æ–‡ä»¶ç»„ä»¶
      {
        test: /\.vue$/,
        loader: 'vue-loader'
      },
      // å¤„ç† TypeScript
      {
        test: /\.ts$/,
        use: 'ts-loader',
        exclude: /node_modules/
      },
      // å¤„ç† CSS
      {
        test: /\.css$/,
        use: [
          'style-loader',  // 3. å°† CSS æ³¨å…¥ DOM
          'css-loader',    // 2. è§£æ CSS ä¸º JS
          'postcss-loader' // 1. å¤„ç† CSS (autoprefixer ç­‰)
        ]
      },
      // å¤„ç†å›¾ç‰‡
      {
        test: /\.(png|jpg|gif)$/,
        type: 'asset/resource',
        generator: {
          filename: 'images/[hash][ext]'
        }
      }
    ]
  }
}
```

**Loader é“¾å¼è°ƒç”¨**:
```
.scss æ–‡ä»¶
  â†“ sass-loader (SCSS â†’ CSS)
  â†“ postcss-loader (CSSå¤„ç†,å¦‚ autoprefixer)
  â†“ css-loader (CSS â†’ JSæ¨¡å—)
  â†“ style-loader (æ³¨å…¥åˆ°DOM)
æœ€ç»ˆ <style> æ ‡ç­¾
```

#### 4. Plugin (æ’ä»¶)

**å®šä¹‰**:æ‰©å±• Webpack åŠŸèƒ½,æ‰§è¡Œæ›´å¹¿æ³›çš„ä»»åŠ¡ã€‚

**Loader vs Plugin**:
- **Loader**:æ–‡ä»¶è½¬æ¢ (è½¬æ¢å•ä¸ªæ–‡ä»¶)
- **Plugin**:æ„å»ºä¼˜åŒ–ã€èµ„æºç®¡ç†ã€ç¯å¢ƒæ³¨å…¥ (æ“ä½œæ•´ä¸ªæ„å»ºæµç¨‹)

**å¸¸ç”¨æ’ä»¶**:

```javascript
const HtmlWebpackPlugin = require('html-webpack-plugin')
const MiniCssExtractPlugin = require('mini-css-extract-plugin')
const { VueLoaderPlugin } = require('vue-loader')

module.exports = {
  plugins: [
    // è‡ªåŠ¨ç”Ÿæˆ HTML å¹¶æ³¨å…¥æ‰“åŒ…åçš„ JS
    new HtmlWebpackPlugin({
      template: './public/index.html',
      favicon: './public/favicon.ico'
    }),

    // æå– CSS åˆ°å•ç‹¬æ–‡ä»¶
    new MiniCssExtractPlugin({
      filename: 'css/[name].[contenthash].css'
    }),

    // Vue å•æ–‡ä»¶ç»„ä»¶æ”¯æŒ
    new VueLoaderPlugin(),

    // å®šä¹‰ç¯å¢ƒå˜é‡
    new webpack.DefinePlugin({
      'process.env.NODE_ENV': JSON.stringify('production')
    })
  ]
}
```

#### 5. Mode (æ¨¡å¼)

**å®šä¹‰**:å‘Šè¯‰ Webpack ä½¿ç”¨ç›¸åº”ç¯å¢ƒçš„ä¼˜åŒ–ã€‚

```javascript
module.exports = {
  mode: 'development'  // æˆ– 'production' æˆ– 'none'
}
```

**å·®å¼‚**:

| ç‰¹æ€§ | development | production |
|------|------------|-----------|
| **ä»£ç å‹ç¼©** | âŒ å¦ | âœ… æ˜¯ (TerserPlugin) |
| **Source Map** | âœ… è¯¦ç»† | âš ï¸ ç®€åŒ– |
| **Tree Shaking** | âŒ å¦ | âœ… æ˜¯ |
| **ä¼˜åŒ–** | âŒ å¦ | âœ… æ˜¯ |
| **æ„å»ºé€Ÿåº¦** | âš¡ å¿« | ğŸ¢ æ…¢ |
| **æ–‡ä»¶å¤§å°** | ğŸ“¦ å¤§ | ğŸ“¦ å° |

### Webpack å·¥ä½œæµç¨‹

#### å®Œæ•´æ„å»ºæµç¨‹

```
1. åˆå§‹åŒ–
   â”œâ”€ è¯»å– webpack.config.js
   â”œâ”€ åˆå¹¶å‘½ä»¤è¡Œå‚æ•°
   â””â”€ åˆå§‹åŒ– Compiler å¯¹è±¡

2. ç¼–è¯‘é˜¶æ®µ
   â”œâ”€ ä» Entry å¼€å§‹
   â”œâ”€ é€’å½’è§£æä¾èµ–
   â”‚  â”œâ”€ è¯»å–æ–‡ä»¶å†…å®¹
   â”‚  â”œâ”€ åŒ¹é… Loader è§„åˆ™
   â”‚  â”œâ”€ ä½¿ç”¨ Loader è½¬æ¢
   â”‚  â””â”€ è§£æ import/require
   â””â”€ æ„å»ºä¾èµ–å›¾ (Module Graph)

3. ä¼˜åŒ–é˜¶æ®µ
   â”œâ”€ Tree Shaking (ç§»é™¤æ­»ä»£ç )
   â”œâ”€ Code Splitting (ä»£ç åˆ†å‰²)
   â”œâ”€ Scope Hoisting (ä½œç”¨åŸŸæå‡)
   â””â”€ Minification (ä»£ç å‹ç¼©)

4. è¾“å‡ºé˜¶æ®µ
   â”œâ”€ æ ¹æ®ä¾èµ–å›¾ç”Ÿæˆ Chunk
   â”œâ”€ ä½¿ç”¨ Plugin å¤„ç† Chunk
   â”œâ”€ ç”Ÿæˆæœ€ç»ˆä»£ç 
   â””â”€ å†™å…¥æ–‡ä»¶ç³»ç»Ÿ
```

#### ä¾èµ–å›¾ç¤ºä¾‹

**ä½ çš„ Vue é¡¹ç›®**:

```
main.js (entry)
â”œâ”€ vue (node_modules)
â”‚  â”œâ”€ @vue/runtime-core
â”‚  â””â”€ @vue/reactivity
â”œâ”€ App.vue
â”‚  â”œâ”€ Header.vue
â”‚  â”‚  â”œâ”€ logo.png
â”‚  â”‚  â””â”€ styles.css
â”‚  â””â”€ Footer.vue
â”œâ”€ router/index.js
â”‚  â””â”€ vue-router
â””â”€ store/index.js
   â””â”€ pinia

ä¾èµ–å›¾ â†’ Chunk åˆ†å‰² â†’ è¾“å‡ºæ–‡ä»¶
                      â”œâ”€ main.js
                      â”œâ”€ vendor.js (vue + ä¾èµ–)
                      â””â”€ assets/
```

### Webpack é…ç½®ç¤ºä¾‹

#### ä½ çš„ Vue åšå®¢é¡¹ç›® (å¦‚æœç”¨ Webpack)

```javascript
// webpack.config.js (å®Œæ•´ç¤ºä¾‹)
const path = require('path')
const HtmlWebpackPlugin = require('html-webpack-plugin')
const { VueLoaderPlugin } = require('vue-loader')
const MiniCssExtractPlugin = require('mini-css-extract-plugin')

module.exports = {
  // æ¨¡å¼
  mode: process.env.NODE_ENV === 'production' ? 'production' : 'development',

  // å…¥å£
  entry: './src/main.js',

  // è¾“å‡º
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: 'js/[name].[contenthash:8].js',
    chunkFilename: 'js/[name].[contenthash:8].chunk.js',
    clean: true
  },

  // æ¨¡å—è§„åˆ™
  module: {
    rules: [
      // Vue å•æ–‡ä»¶ç»„ä»¶
      {
        test: /\.vue$/,
        loader: 'vue-loader'
      },

      // JavaScript/TypeScript
      {
        test: /\.(js|ts)$/,
        exclude: /node_modules/,
        use: {
          loader: 'babel-loader',
          options: {
            presets: [
              '@babel/preset-env',
              '@babel/preset-typescript'
            ]
          }
        }
      },

      // CSS
      {
        test: /\.css$/,
        use: [
          process.env.NODE_ENV === 'production'
            ? MiniCssExtractPlugin.loader
            : 'style-loader',
          'css-loader',
          'postcss-loader'
        ]
      },

      // SCSS
      {
        test: /\.scss$/,
        use: [
          process.env.NODE_ENV === 'production'
            ? MiniCssExtractPlugin.loader
            : 'style-loader',
          'css-loader',
          'postcss-loader',
          'sass-loader'
        ]
      },

      // å›¾ç‰‡
      {
        test: /\.(png|jpg|jpeg|gif|svg)$/,
        type: 'asset',
        parser: {
          dataUrlCondition: {
            maxSize: 10 * 1024 // 10KBä»¥ä¸‹è½¬base64
          }
        },
        generator: {
          filename: 'images/[hash:8][ext]'
        }
      },

      // å­—ä½“
      {
        test: /\.(woff|woff2|eot|ttf|otf)$/,
        type: 'asset/resource',
        generator: {
          filename: 'fonts/[hash:8][ext]'
        }
      }
    ]
  },

  // æ’ä»¶
  plugins: [
    new VueLoaderPlugin(),

    new HtmlWebpackPlugin({
      template: './public/index.html',
      favicon: './public/favicon.ico',
      minify: process.env.NODE_ENV === 'production'
    }),

    new MiniCssExtractPlugin({
      filename: 'css/[name].[contenthash:8].css'
    })
  ],

  // ä¼˜åŒ–
  optimization: {
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        // æå– node_modules åˆ° vendor
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          priority: 10
        },
        // æå–å…¬å…±ä»£ç 
        common: {
          minChunks: 2,
          priority: 5,
          reuseExistingChunk: true
        }
      }
    },

    // æå– runtime ä»£ç 
    runtimeChunk: 'single'
  },

  // å¼€å‘æœåŠ¡å™¨
  devServer: {
    port: 8080,
    hot: true,  // çƒ­æ›´æ–°
    open: true,
    historyApiFallback: true  // SPA è·¯ç”±æ”¯æŒ
  },

  // Source Map
  devtool: process.env.NODE_ENV === 'production'
    ? 'source-map'
    : 'eval-cheap-module-source-map',

  // è§£æé…ç½®
  resolve: {
    extensions: ['.js', '.ts', '.vue', '.json'],
    alias: {
      '@': path.resolve(__dirname, 'src')
    }
  }
}
```

### Webpack çš„é—®é¢˜

#### 1. å¯åŠ¨æ…¢

**åŸå› **:å¼€å‘æ¨¡å¼ä¹Ÿè¦æ‰“åŒ…æ‰€æœ‰æ–‡ä»¶

```bash
npm run dev  # Webpack
# Compiling...
# [ç­‰å¾… 30-60 ç§’]
# Compiled successfully!
```

**ä½ çš„ Vue åšå®¢ (800+ ä¾èµ–)**:
- å†·å¯åŠ¨:30-60 ç§’
- çƒ­æ›´æ–°:1-3 ç§’

#### 2. é…ç½®å¤æ‚

```javascript
// éœ€è¦ç†è§£è¿™ä¹ˆå¤šæ¦‚å¿µ
entry, output, loader, plugin, mode,
optimization, devServer, resolve, ...

// å¸¸è§é”™è¯¯
- Loader é¡ºåºé”™è¯¯
- Plugin å†²çª
- Source Map é…ç½®ä¸å¯¹
- è·¯å¾„è§£æé—®é¢˜
```

#### 3. çƒ­æ›´æ–°æ…¢ (å¤§å‹é¡¹ç›®)

```
ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶
  â†“
Webpack é‡æ–°æ‰“åŒ…æ•´ä¸ª bundle
  â†“ (éœ€è¦ 1-5 ç§’)
æµè§ˆå™¨åˆ·æ–°
```

---

## Vite è¯¦è§£

### é©å‘½æ€§åˆ›æ–°

**Vite** (æ³•è¯­:"å¿«")

**æ ¸å¿ƒç†å¿µ**:
> "No bundle in development"
> (å¼€å‘ç¯å¢ƒä¸æ‰“åŒ…)

### ä¸ºä»€ä¹ˆ Vite è¿™ä¹ˆå¿«?

#### ä¼ ç»Ÿæ‰“åŒ…å·¥å…· (Webpack)

```
å¯åŠ¨å¼€å‘æœåŠ¡å™¨:

1. è¯»å–æ‰€æœ‰æ–‡ä»¶
2. è½¬æ¢æ‰€æœ‰æ–‡ä»¶ (Babel/TypeScript)
3. æ‰“åŒ…æ‰€æœ‰æ¨¡å— â†’ bundle.js
4. å¯åŠ¨æœåŠ¡å™¨
5. æµè§ˆå™¨åŠ è½½ bundle.js

æ€»è€—æ—¶:30-60 ç§’ (å¤§å‹é¡¹ç›®)
```

#### Vite çš„æ–¹å¼

```
å¯åŠ¨å¼€å‘æœåŠ¡å™¨:

1. å¯åŠ¨æœåŠ¡å™¨ (ç¬é—´å®Œæˆ!)
2. æµè§ˆå™¨è¯·æ±‚ /src/main.js
3. Vite å®æ—¶è½¬æ¢å¹¶è¿”å›
4. æµè§ˆå™¨è§£æ import,ç»§ç»­è¯·æ±‚
5. Vite æŒ‰éœ€è½¬æ¢è¿”å›

æ€»è€—æ—¶:1-2 ç§’ (ä¸ç®¡é¡¹ç›®å¤šå¤§)
```

### Vite çš„æ ¸å¿ƒæŠ€æœ¯

#### 1. ESM (ES Modules)

**æµè§ˆå™¨åŸç”Ÿæ”¯æŒ**:
```javascript
// ç°ä»£æµè§ˆå™¨å¯ä»¥ç›´æ¥è¿è¡Œ
<script type="module">
  import { createApp } from 'vue'
  import App from './App.vue'

  createApp(App).mount('#app')
</script>
```

**Vite åˆ©ç”¨è¿™ä¸€ç‚¹**:
```html
<!-- å¼€å‘ç¯å¢ƒ (Vite) -->
<script type="module" src="/src/main.js"></script>

<!-- æµè§ˆå™¨è¯·æ±‚ main.js -->
GET /src/main.js
â†’ Vite è¿”å›è½¬æ¢åçš„ä»£ç 

<!-- æµè§ˆå™¨å‘ç° import App from './App.vue' -->
GET /src/App.vue
â†’ Vite å®æ—¶ç¼–è¯‘ Vue æ–‡ä»¶å¹¶è¿”å›

<!-- ç»§ç»­é€’å½’åŠ è½½ä¾èµ–... -->
```

#### 2. ä¾èµ–é¢„æ„å»º (Dependency Pre-Bundling)

**é—®é¢˜**:`node_modules` ä¸­çš„åŒ…ä¸æ˜¯ ESM æ ¼å¼

```javascript
// lodash æ˜¯ CommonJS æ ¼å¼
const _ = require('lodash')  // æµè§ˆå™¨ä¸æ”¯æŒ require
```

**Vite çš„è§£å†³**:
```
é¦–æ¬¡å¯åŠ¨æ—¶:
1. æ‰«æ node_modules
2. ä½¿ç”¨ esbuild é¢„æ„å»ºä¸º ESM æ ¼å¼
3. ç¼“å­˜åˆ° node_modules/.vite/
4. æµè§ˆå™¨å¯ä»¥ç›´æ¥åŠ è½½

åªéœ€æ‰§è¡Œä¸€æ¬¡,ä¹‹åä½¿ç”¨ç¼“å­˜
```

**é€Ÿåº¦å¯¹æ¯”**:
```bash
# esbuild (Vite ä½¿ç”¨çš„)
é¢„æ„å»º 800 ä¸ªåŒ…:1-2 ç§’

# Webpack (ä½¿ç”¨ Babel)
æ‰“åŒ… 800 ä¸ªåŒ…:30-60 ç§’

å·®è·:15-30 å€!
```

#### 3. æŒ‰éœ€ç¼–è¯‘

**Webpack**:
```
å¯åŠ¨æ—¶ç¼–è¯‘æ‰€æœ‰æ–‡ä»¶ (1000 ä¸ªæ–‡ä»¶)
â†’ å³ä½¿ä½ åªè®¿é—®é¦–é¡µ (åªéœ€è¦ 50 ä¸ªæ–‡ä»¶)
```

**Vite**:
```
åªç¼–è¯‘æµè§ˆå™¨è¯·æ±‚çš„æ–‡ä»¶
â†’ è®¿é—®é¦–é¡µ:ç¼–è¯‘ 50 ä¸ªæ–‡ä»¶
â†’ è®¿é—® /about:ç¼–è¯‘é¢å¤–çš„ 20 ä¸ªæ–‡ä»¶

æœªè®¿é—®çš„é¡µé¢:ä¸ç¼–è¯‘
```

#### 4. HMR (çƒ­æ¨¡å—æ›¿æ¢)

**Webpack HMR**:
```
ä¿®æ”¹ Header.vue
  â†“
é‡æ–°æ‰“åŒ…å—å½±å“çš„ bundle
  â†“ (1-3 ç§’)
æµè§ˆå™¨åˆ·æ–°
```

**Vite HMR**:
```
ä¿®æ”¹ Header.vue
  â†“
åªé‡æ–°ç¼–è¯‘ Header.vue (å’Œä¾èµ–å®ƒçš„ç»„ä»¶)
  â†“ (< 50ms)
æµè§ˆå™¨çƒ­æ›´æ–° (ä¸åˆ·æ–°é¡µé¢)
```

### Vite é…ç½®ç¤ºä¾‹

#### ä½ çš„ Vue åšå®¢é¡¹ç›® (å®é™…ä½¿ç”¨ Vite)

```javascript
// vite.config.ts (ç®€åŒ–ç‰ˆ)
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import path from 'path'

export default defineConfig({
  // æ’ä»¶ (ç®€å•å¤šäº†!)
  plugins: [
    vue()  // Vue æ”¯æŒåªéœ€è¦ä¸€ä¸ªæ’ä»¶
  ],

  // è§£æé…ç½®
  resolve: {
    alias: {
      '@': path.resolve(__dirname, 'src')
    }
  },

  // å¼€å‘æœåŠ¡å™¨
  server: {
    port: 5173,
    open: true,
    // ä»£ç†é…ç½® (è§£å†³è·¨åŸŸ)
    proxy: {
      '/api': {
        target: 'http://backend.example.com',
        changeOrigin: true
      }
    }
  },

  // æ„å»ºé…ç½®
  build: {
    outDir: 'dist',
    assetsDir: 'assets',
    // Rollup é€‰é¡¹
    rollupOptions: {
      output: {
        // åˆ†åŒ…ç­–ç•¥
        manualChunks: {
          'vue-vendor': ['vue', 'vue-router', 'pinia'],
          'ui-vendor': ['element-plus']
        }
      }
    },
    // ä»£ç åˆ†å‰²é˜ˆå€¼
    chunkSizeWarningLimit: 1000
  },

  // CSS é…ç½®
  css: {
    preprocessorOptions: {
      scss: {
        additionalData: `@import "@/styles/variables.scss";`
      }
    }
  }
})
```

**å¯¹æ¯” Webpack é…ç½®**:
- Webpack:200+ è¡Œ
- Vite:50 è¡Œ
- é…ç½®æ›´ç®€å•,ä½†åŠŸèƒ½ç›¸åŒ!

### Vite ç”Ÿäº§æ„å»º

**å¼€å‘ç¯å¢ƒ**:ESM + æŒ‰éœ€ç¼–è¯‘ (å¿«)

**ç”Ÿäº§ç¯å¢ƒ**:Rollup æ‰“åŒ… (ä¼˜åŒ–)

**ä¸ºä»€ä¹ˆç”Ÿäº§ç¯å¢ƒè¦æ‰“åŒ…?**
```
åŸå› :
1. HTTP è¯·æ±‚å¤ªå¤šå½±å“æ€§èƒ½
2. éœ€è¦ Tree Shaking
3. éœ€è¦ä»£ç å‹ç¼©
4. éœ€è¦ Code Splitting
```

**æ„å»ºæµç¨‹**:
```bash
npm run build

# Vite ä½¿ç”¨ Rollup æ‰“åŒ…
vite v7.0.6 building for production...
âœ“ 500 modules transformed.
dist/index.html                    0.45 kB
dist/assets/index-abc123.css      15.20 kB â”‚ gzip:  3.50 kB
dist/assets/index-def456.js      150.30 kB â”‚ gzip: 48.20 kB

âœ“ built in 5.23s
```

---

## Webpack vs Vite å¯¹æ¯”

### å®Œæ•´å¯¹æ¯”è¡¨

| ç‰¹æ€§ | Webpack | Vite |
|------|---------|------|
| **å¼€å‘å¯åŠ¨** | 30-60ç§’ | 1-2ç§’ |
| **çƒ­æ›´æ–° (HMR)** | 1-3ç§’ | <50ms |
| **å¼€å‘æ¨¡å¼åŸç†** | æ‰“åŒ…æ‰€æœ‰æ–‡ä»¶ | ESM + æŒ‰éœ€ç¼–è¯‘ |
| **ç”Ÿäº§æ„å»º** | Webpack | Rollup |
| **é…ç½®å¤æ‚åº¦** | â­â­â­â­â­ | â­â­ |
| **å­¦ä¹ æ›²çº¿** | é™¡å³­ | å¹³ç¼“ |
| **ç”Ÿæ€æˆç†Ÿåº¦** | â­â­â­â­â­ | â­â­â­â­ |
| **æ’ä»¶æ•°é‡** | æ•°åƒä¸ª | æ•°ç™¾ä¸ª |
| **å¤§å‹é¡¹ç›®æ”¯æŒ** | â­â­â­â­ | â­â­â­â­â­ |
| **å…¼å®¹æ€§** | å…¨é¢ | éœ€è¦ç°ä»£æµè§ˆå™¨ |
| **Monorepo æ”¯æŒ** | â­â­â­ | â­â­â­â­ |

### å®é™…ä½“éªŒå¯¹æ¯”

#### ä½ çš„ Vue åšå®¢é¡¹ç›®

**å¦‚æœç”¨ Webpack**:
```bash
$ npm run dev
Compiling...
# [ç­‰å¾… 30-60 ç§’]
webpack 5.91.0 compiled successfully in 45231 ms

# ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶
# [ç­‰å¾… 1-3 ç§’]
Compiled successfully in 2134 ms
```

**å®é™…ä½¿ç”¨ Vite**:
```bash
$ npm run dev
  VITE v7.0.6  ready in 1254 ms

  âœ  Local:   http://localhost:5173/
  âœ  Network: use --host to expose

# ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶
# [å‡ ä¹ç¬é—´]
[vite] hmr update /src/components/Header.vue
```

### é€‰æ‹©å»ºè®®

**é€‰æ‹© Webpack å¦‚æœ**:
- éœ€è¦æ”¯æŒ IE æµè§ˆå™¨
- éœ€è¦éå¸¸ç‰¹æ®Šçš„ Loader/Plugin
- å›¢é˜Ÿå·²æœ‰å¤§é‡ Webpack ç»éªŒ
- é¡¹ç›®å·²ç”¨ Webpack (è¿ç§»æˆæœ¬é«˜)

**é€‰æ‹© Vite å¦‚æœ**:
- æ–°é¡¹ç›®
- åªéœ€æ”¯æŒç°ä»£æµè§ˆå™¨
- è¿½æ±‚å¼€å‘ä½“éªŒ
- Vue/React/Svelte é¡¹ç›® (å®˜æ–¹æ”¯æŒ)

**è¶‹åŠ¿**:
```
2020 å¹´:Webpack å ä¸»å¯¼
2022 å¹´:Vite å¿«é€Ÿå´›èµ·
2024 å¹´:Vite æˆä¸ºæ–°é¡¹ç›®é¦–é€‰
```

---

## Rollup è¯¦è§£

### å®šä½

**Rollup** = åº“æ‰“åŒ…ä¸“å®¶

**ç‰¹ç‚¹**:
- ä¸“ä¸º JavaScript åº“è®¾è®¡
- è¾“å‡ºä»£ç å¹²å‡€
- Tree Shaking æœ€å¥½
- ä¸é€‚åˆæ‰“åŒ…åº”ç”¨ (ç¼ºå°‘ä»£ç åˆ†å‰²ã€HMR ç­‰)

### ä¸ºä»€ä¹ˆé€‚åˆåº“?

**åº“çš„éœ€æ±‚**:
```
âœ… è¾“å‡º ESM/CJS/UMD å¤šç§æ ¼å¼
âœ… ä½“ç§¯å° (Tree Shaking)
âœ… ä»£ç å¯è¯» (æ–¹ä¾¿è°ƒè¯•)
âŒ ä¸éœ€è¦ HMR
âŒ ä¸éœ€è¦å¼€å‘æœåŠ¡å™¨
```

**Webpack æ‰“åŒ…çš„åº“**:
```javascript
// åŒ…å«å¤§é‡ Webpack runtime ä»£ç 
(function(modules) {
  var installedModules = {};
  function __webpack_require__(moduleId) {
    // ...å¤§é‡ runtime ä»£ç 
  }
  // ...
})({
  "./src/index.js": function(module, exports) {
    // ä½ çš„ä»£ç 
  }
})
```

**Rollup æ‰“åŒ…çš„åº“**:
```javascript
// å¹²å‡€ç®€æ´
function add(a, b) {
  return a + b
}

export { add }
```

### é…ç½®ç¤ºä¾‹

```javascript
// rollup.config.js
import resolve from '@rollup/plugin-node-resolve'
import commonjs from '@rollup/plugin-commonjs'
import typescript from '@rollup/plugin-typescript'
import { terser } from 'rollup-plugin-terser'

export default {
  input: 'src/index.ts',

  output: [
    // ESM (ç”¨äºç°ä»£æ‰“åŒ…å·¥å…·)
    {
      file: 'dist/my-lib.esm.js',
      format: 'es'
    },
    // CJS (ç”¨äº Node.js)
    {
      file: 'dist/my-lib.cjs.js',
      format: 'cjs'
    },
    // UMD (ç”¨äºæµè§ˆå™¨ <script> æ ‡ç­¾)
    {
      file: 'dist/my-lib.umd.js',
      format: 'umd',
      name: 'MyLib'
    },
    // å‹ç¼©ç‰ˆ
    {
      file: 'dist/my-lib.min.js',
      format: 'umd',
      name: 'MyLib',
      plugins: [terser()]
    }
  ],

  plugins: [
    resolve(),      // è§£æ node_modules
    commonjs(),     // è½¬æ¢ CommonJS
    typescript()    // ç¼–è¯‘ TypeScript
  ],

  external: ['vue']  // å¤–éƒ¨ä¾èµ– (ä¸æ‰“åŒ…è¿›åº“)
}
```

### Rollup vs Webpack (åº“æ‰“åŒ…)

**æ‰“åŒ…ä¸€ä¸ªç®€å•çš„å·¥å…·åº“**:

| å·¥å…· | è¾“å‡ºå¤§å° | ä»£ç å¯è¯»æ€§ | é…ç½®å¤æ‚åº¦ |
|------|---------|-----------|-----------|
| Rollup | 2KB | â­â­â­â­â­ | â­â­ |
| Webpack | 5KB | â­â­ | â­â­â­â­ |

**ç»“è®º**:Vite ç”Ÿäº§æ„å»ºä½¿ç”¨ Rollup å°±æ˜¯å› ä¸ºè¿™ä¸ªä¼˜åŠ¿ã€‚

---

## Parcel è¯¦è§£

### å®šä½

**Parcel** = é›¶é…ç½®æ‰“åŒ…å·¥å…·

**å£å·**:
> "Blazing fast, zero configuration web application bundler"

### ç‰¹ç‚¹

**ä¼˜ç‚¹**:
```
âœ… é›¶é…ç½® (çœŸçš„é›¶é…ç½®!)
âœ… è‡ªåŠ¨å®‰è£…ä¾èµ–
âœ… å†…ç½®å¸¸è§æ–‡ä»¶ç±»å‹æ”¯æŒ
âœ… å¼€ç®±å³ç”¨çš„ä»£ç åˆ†å‰²
âœ… çƒ­æ›´æ–°é€Ÿåº¦å¿«
```

**ç¼ºç‚¹**:
```
âŒ ç”Ÿæ€è¾ƒå°
âŒ å¯å®šåˆ¶æ€§å·®
âŒ å¤§å‹é¡¹ç›®æ”¯æŒä¸å¦‚ Webpack/Vite
âŒ ç¤¾åŒºæ´»è·ƒåº¦ä½
```

### ä½¿ç”¨ç¤ºä¾‹

```bash
# å®‰è£…
npm install --save-dev parcel

# å¼€å‘
npx parcel src/index.html
# è‡ªåŠ¨å¯åŠ¨æœåŠ¡å™¨,è‡ªåŠ¨å¤„ç†æ‰€æœ‰ä¾èµ–

# æ„å»º
npx parcel build src/index.html
```

**ä¸éœ€è¦ä»»ä½•é…ç½®æ–‡ä»¶!**

```html
<!-- src/index.html -->
<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="./styles.scss">
</head>
<body>
  <div id="app"></div>
  <script type="module" src="./main.ts"></script>
</body>
</html>
```

Parcel è‡ªåŠ¨å¤„ç†:
- TypeScript
- SCSS
- Vue/React
- å›¾ç‰‡
- ...

---

## å…¶ä»–å·¥å…·ç®€ä»‹

### esbuild

**ç‰¹ç‚¹**:ç”¨ Go è¯­è¨€ç¼–å†™,é€Ÿåº¦æå¿«

**é€Ÿåº¦å¯¹æ¯”**:
```
æ‰“åŒ…ç›¸åŒé¡¹ç›®:
esbuild:  0.5 ç§’
Webpack: 30 ç§’

å·®è·:60 å€!
```

**ä½†æ˜¯**:
- åŠŸèƒ½ç›¸å¯¹ç®€å•
- ç”Ÿæ€ä¸å¤Ÿæˆç†Ÿ
- é€šå¸¸ä½œä¸ºå…¶ä»–å·¥å…·çš„åº•å±‚ (Vite ç”¨å®ƒé¢„æ„å»º)

### SWC

**ç‰¹ç‚¹**:ç”¨ Rust ç¼–å†™çš„ JavaScript/TypeScript ç¼–è¯‘å™¨

**å¯¹æ¯” Babel**:
```
è½¬è¯‘ç›¸åŒä»£ç :
SWC:   0.1 ç§’
Babel: 2.5 ç§’

å·®è·:25 å€!
```

**ä½¿ç”¨åœºæ™¯**:
- æ›¿ä»£ Babel (Next.js 13+ é»˜è®¤ä½¿ç”¨)
- æ›¿ä»£ Terser (ä»£ç å‹ç¼©)

### Turbopack

**ç‰¹ç‚¹**:Vercel (Next.js å›¢é˜Ÿ) å¼€å‘çš„æ–°ä¸€ä»£æ‰“åŒ…å·¥å…·

**çŠ¶æ€**:å®éªŒæ€§ (2024å¹´)

**ç›®æ ‡**:æ¯” Webpack å¿« 700 å€,æ¯” Vite å¿« 10 å€

---

## æ€»ç»“

### æŠ€æœ¯æ¼”è¿›

```
2012-2015: Gulp/Grunt (ä»»åŠ¡è¿è¡Œå™¨)
2015-2020: Webpack (æ‰“åŒ…é©å‘½)
2020-ç°åœ¨: Vite (é€Ÿåº¦é©å‘½)
æœªæ¥:     Turbopack? (Rustæ—¶ä»£?)
```

### å·¥å…·é€‰æ‹©çŸ©é˜µ

| åœºæ™¯ | æ¨èå·¥å…· | åŸå›  |
|------|---------|------|
| **æ–°çš„ Vue/React åº”ç”¨** | Vite | å¿«ã€ç®€å•ã€ç°ä»£ |
| **è€é¡¹ç›®ç»´æŠ¤** | Webpack | å·²æœ‰é…ç½®,ç¨³å®š |
| **åº“/ç»„ä»¶å¼€å‘** | Rollup | è¾“å‡ºå¹²å‡€ |
| **å¿«é€ŸåŸå‹** | Parcel | é›¶é…ç½® |
| **è¿½æ±‚æè‡´æ€§èƒ½** | esbuild + è‡ªå®šä¹‰ | æœ€å¿« |
| **å¤§å‹ä¼ä¸šé¡¹ç›®** | Webpack | ç”Ÿæ€æœ€æˆç†Ÿ |

### ä½ çš„ Vue åšå®¢é¡¹ç›®

**å®é™…ä½¿ç”¨**:Vite

**ä¸ºä»€ä¹ˆ?**
```
âœ… Vue 3 å®˜æ–¹æ¨è
âœ… å¼€å‘ä½“éªŒæä½³ (1ç§’å¯åŠ¨)
âœ… çƒ­æ›´æ–°å¿«é€Ÿ (<50ms)
âœ… é…ç½®ç®€å• (50è¡Œ vs Webpack çš„ 200è¡Œ)
âœ… ç”Ÿäº§æ„å»ºä¼˜åŒ– (Rollup)
```

**package.json**:
```json
{
  "scripts": {
    "dev": "vite",              // å¼€å‘æœåŠ¡å™¨
    "build": "vite build",      // ç”Ÿäº§æ„å»º
    "preview": "vite preview"   // é¢„è§ˆæ„å»ºç»“æœ
  },
  "devDependencies": {
    "vite": "^7.0.6",
    "@vitejs/plugin-vue": "^5.0.0"
  }
}
```

### æ ¸å¿ƒæ¦‚å¿µå›é¡¾

**æ‰“åŒ…å·¥å…·çš„æœ¬è´¨**:
1. **å¼€å‘ç¯å¢ƒ**:æä¾›å¿«é€Ÿåé¦ˆå¾ªç¯ (HMRã€å¿«é€Ÿå¯åŠ¨)
2. **ç”Ÿäº§ç¯å¢ƒ**:ä¼˜åŒ–è¾“å‡º (Tree Shakingã€å‹ç¼©ã€åˆ†å‰²)

**æŠ€æœ¯è¶‹åŠ¿**:
- ä» JavaScript (Webpack) åˆ°åŸç”Ÿè¯­è¨€ (esbuild/Go, SWC/Rust)
- ä»é¢„æ‰“åŒ… (Webpack) åˆ°æŒ‰éœ€ (Vite/ESM)
- ä»å¤æ‚é…ç½®åˆ°é›¶é…ç½®

---

**ä¸‹ä¸€æ­¥**:é˜…è¯» [03-åç«¯è¯­è¨€çš„æ„å»ºæ–¹å¼.md](./03-åç«¯è¯­è¨€çš„æ„å»ºæ–¹å¼.md) äº†è§£ä¸ºä»€ä¹ˆ Pythonã€Java ç­‰è¯­è¨€çš„æ„å»ºæ–¹å¼å¦‚æ­¤ä¸åŒ
