# Chapter 17 - å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ (Threading and Multiprocessing)

> **æœ¬ç« ä¸»é¢˜**: Python çš„å¹¶å‘ç¼–ç¨‹
> **é¢å‘**: æœ‰ Java å¼€å‘ç»éªŒçš„å­¦ä¹ è€…

---

## æ ¸å¿ƒçŸ¥è¯†ç‚¹

### 1. å¤šçº¿ç¨‹ (threading)

#### Python å®ç°



```python
import threading

def worker(name):
    print(f"Worker {name} starting")
    # æ‰§è¡Œä»»åŠ¡...
    print(f"Worker {name} done")

# åˆ›å»ºçº¿ç¨‹
threads = []
for i in range(5):
    t = threading.Thread(target=worker, args=(i,))
    threads.append(t)
    t.start()

# ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
for t in threads:
    t.join()
```



#### Java å¯¹æ¯”
```java
class Worker implements Runnable {
    private String name;

    public void run() {
        System.out.println("Worker " + name + " starting");
        // æ‰§è¡Œä»»åŠ¡...
        System.out.println("Worker " + name + " done");
    }
}

// åˆ›å»ºçº¿ç¨‹
List<Thread> threads = new ArrayList<>();
for (int i = 0; i < 5; i++) {
    Thread t = new Thread(new Worker(String.valueOf(i)));
    threads.add(t);
    t.start();
}

// ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
for (Thread t : threads) {
    t.join();
}
```


#### ğŸ’¡ Javaer æ³¨æ„äº‹é¡¹
- âœ… Python threading â‰ˆ Java Thread
- âš ï¸ **Python æœ‰ GIL (å…¨å±€è§£é‡Šå™¨é”)**,å¤šçº¿ç¨‹ä¸é€‚åˆ CPU å¯†é›†å‹ä»»åŠ¡
- âœ… å¤šçº¿ç¨‹é€‚åˆ I/O å¯†é›†å‹ä»»åŠ¡
- ğŸ“Œ è®°å¿†: "Python å¤šçº¿ç¨‹å— GIL é™åˆ¶"


**ç›¸å…³æ–‡ä»¶:** `collatz_multi.py`

---



### 2. å¤šè¿›ç¨‹ (multiprocessing)


#### Python å®ç°
```python
from multiprocessing import Process, Pool

def worker(name):
    print(f"Worker {name} in process")

# æ–¹å¼ 1: Process
processes = []
for i in range(5):
    p = Process(target=worker, args=(i,))
    processes.append(p)
    p.start()

for p in processes:
    p.join()

# æ–¹å¼ 2: Pool (æ¨è)
with Pool(4) as pool:
    results = pool.map(worker, range(5))
```



#### Java å¯¹æ¯”

```java
// Java æ²¡æœ‰å†…ç½®å¤šè¿›ç¨‹,ä½¿ç”¨çº¿ç¨‹æ± 
ExecutorService executor = Executors.newFixedThreadPool(4);

for (int i = 0; i < 5; i++) {
    final int id = i;
    executor.submit(() -> worker(String.valueOf(id)));
}

executor.shutdown();
executor.awaitTermination(1, TimeUnit.HOURS);
```

#### ğŸ’¡ Javaer æ³¨æ„äº‹é¡¹
- âš ï¸ Python å¤šè¿›ç¨‹ç»•è¿‡ GIL,é€‚åˆ CPU å¯†é›†å‹ä»»åŠ¡
- âœ… `Pool` â‰ˆ Java `ExecutorService`
- ğŸ“Œ è®°å¿†: "å¤šè¿›ç¨‹ = çœŸæ­£çš„å¹¶è¡Œè®¡ç®—"

**ç›¸å…³æ–‡ä»¶:** `collatz_pool.py`




---

## æ€»ç»“

| ç‰¹æ€§ | Python | Java |
|------|--------|------|
| å¤šçº¿ç¨‹ | `threading` | `Thread` |
| GIL | âœ… æœ‰ (é™åˆ¶å¤šçº¿ç¨‹) | âŒ æ—  |
| å¤šè¿›ç¨‹ | `multiprocessing` | `ProcessBuilder` (è¾ƒå°‘ç”¨) |
| çº¿ç¨‹æ±  | `ThreadPoolExecutor` | `ExecutorService` |
| è¿›ç¨‹æ±  | `Pool` | æ— å†…ç½® |

---

**åˆ¶ä½œæ—¶é—´:** 2025-11-25
**åŸºäº:** DeadSimplePython Chapter 17 ç¤ºä¾‹ä»£ç 
